<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>API documentation &#8212; proseco 5.18.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-astropy.css?v=f4f7060c" />
    
    <script src="_static/documentation_options.js?v=35f5b738"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Unit tests" href="unit_tests.html" />
    <link rel="prev" title="Proseco" href="index.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="index.html"><span id="logotext1">Ska!</span><span id="logotext2">proseco</span><span id="logotext3"></span></a>
  <ul>
    
    <li><a class="home" title="Homepage" href="https://cxc.cfa.harvard.edu/mta/ASPECT/tool_doc">
        <span id="logotext1">ska</span><span id="logotext2">tools</span>
    </a></li>
    <li><a title="General Index" href="genindex.html">Index</a></li>
    <li><a title="Module Index" href="py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="unit_tests.html" title="Unit tests">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="index.html" title="Proseco">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="index.html">proseco 5.18.0 documentation</a>
	 &#187;
      </li>
      
      <li>API documentation</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="api-documentation">
<h1>API documentation<a class="headerlink" href="#api-documentation" title="Link to this heading">¶</a></h1>
<section id="module-proseco.catalog">
<span id="full-catalog"></span><h2>Full catalog<a class="headerlink" href="#module-proseco.catalog" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="proseco.catalog.ACATable">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">proseco.catalog.</span></span><span class="sig-name descname"><span class="pre">ACATable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/catalog.html#ACATable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.catalog.ACATable" title="Link to this definition">¶</a></dt>
<dd><p>Container ACACatalogTable class that has merged guide / acq / fid catalogs
as attributes and other methods relevant to the merged catalog.</p>
<dl class="py method">
<dt class="sig sig-object py" id="proseco.catalog.ACATable.empty">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/catalog.html#ACATable.empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.catalog.ACATable.empty" title="Link to this definition">¶</a></dt>
<dd><p>Return a minimal ACACatalogTable which satisfies API requirements.  Currently
this means that it has an ‘id’ column which can be examined for length.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>StarsTable of stars (empty)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.catalog.ACATable.get_candidates_mask">
<span class="sig-name descname"><span class="pre">get_candidates_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/catalog.html#ACATable.get_candidates_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.catalog.ACATable.get_candidates_mask" title="Link to this definition">¶</a></dt>
<dd><p>Return a boolean mask indicating which <code class="docutils literal notranslate"><span class="pre">stars</span></code> are acceptable candidates
for the parent class.</p>
<p>For ACATable this is the logical OR of the guide and acq values,
i.e. for ACA a candidate is shown as OK if it is OK for either guide or
acq.  This is just used for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stars</strong> – StarsTable of stars</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bool mask</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.catalog.ACATable.get_review_table">
<span class="sig-name descname"><span class="pre">get_review_table</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/catalog.html#ACATable.get_review_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.catalog.ACATable.get_review_table" title="Link to this definition">¶</a></dt>
<dd><p>Get ACAReviewTable object based on self.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ACAReviewTable object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.catalog.ACATable.make_report">
<span class="sig-name descname"><span class="pre">make_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rootdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/catalog.html#ACATable.make_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.catalog.ACATable.make_report" title="Link to this definition">¶</a></dt>
<dd><p>Make summary HTML report for acq and guide selection process and outputs.</p>
<p>Outputs are in <code class="docutils literal notranslate"><span class="pre">&lt;rootdir&gt;/obs&lt;obsid&gt;/{acq,guide}/index.html</span></code> plus related
images in that directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rootdir</strong> – root directory for outputs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.catalog.ACATable.optimize_acqs_fids">
<span class="sig-name descname"><span class="pre">optimize_acqs_fids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_guide_cands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/catalog.html#ACATable.optimize_acqs_fids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.catalog.ACATable.optimize_acqs_fids" title="Link to this definition">¶</a></dt>
<dd><p>Concurrently optimize acqs and fids in the case where there is not
already a good (no spoilers) fid set available.</p>
<p>This updates the acqs and fids tables in place. The optimization considers
both acquisition star probability (P2) and guide star count to find the
best fid set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_guide_cands</strong> – Table of initial guide candidates (typically from
get_guide_candidates()). If None, guide candidates are generated internally.</p></li>
<li><p><strong>**kwargs</strong> – <p>additional keyword arguments passed to get_guide_catalog()</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.catalog.ACATable.set_attrs_from_kwargs">
<span class="sig-name descname"><span class="pre">set_attrs_from_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/catalog.html#ACATable.set_attrs_from_kwargs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.catalog.ACATable.set_attrs_from_kwargs" title="Link to this definition">¶</a></dt>
<dd><p>Set object attributes from kwargs.</p>
<p>After calling the base class method which does all the real work, then
compute the effective T_ccd temperatures.</p>
<p>In this ACATable object:</p>
<ul class="simple">
<li><p>t_ccd_eff_{acq,guide} are the effective T_ccd values which are adjusted
if the actual t_ccd{acq,guide} values are above ACA.aca_t_ccd_penalty_limit.</p></li>
<li><p>t_ccd_{acq,guide} are the actual (or predicted) values from the call</p></li>
</ul>
<p>The downstream AcqTable, GuideTable, and FidTable are initialized with the
<em>effective</em> values as t_ccd.  Those classes do not have the concept of effective
temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – dict of input kwargs</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proseco.catalog.ObcCat">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">proseco.catalog.</span></span><span class="sig-name descname"><span class="pre">ObcCat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/catalog.html#ObcCat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.catalog.ObcCat" title="Link to this definition">¶</a></dt>
<dd><p>Slot-based catalog corresponding to OBC 8-element acq and guide catalogs.</p>
<p>Each row is a catalog object (acq, guide, fid, mon) with a dict-like
interface (dict or Table Row). This class is a list subclass with special
properties:</p>
<ul class="simple">
<li><p>Initialized as a length 8 list of dict {‘id’: None, ‘type’: None}</p></li>
<li><p>Each of the 8 items correspond to that ACA slot.</p></li>
<li><p>The default value corresponds to a “empty” slot.</p></li>
<li><p>Setting an entry in a slot that is occupied raises an exception.</p></li>
<li><p>Allows adding an entry to the first/last available slot, doing nothing if
the <code class="docutils literal notranslate"><span class="pre">id</span></code> is already in the catalog.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="proseco.catalog.ObcCat.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/catalog.html#ObcCat.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.catalog.ObcCat.add" title="Link to this definition">¶</a></dt>
<dd><p>Add <code class="docutils literal notranslate"><span class="pre">value</span></code> to catalog in first/last empty slot, returning the slot.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">value['id']</span></code> is already in the catalog then return that slot.</p>
<p>If the catalog already has 8 entries then an IndexError is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> – dict, Row
Catalog entry to add</p></li>
<li><p><strong>descending</strong> – bool
Direction in which to find the first empty slot (starting from
beginning or end of catalog)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int
Slot in which <code class="docutils literal notranslate"><span class="pre">value</span></code> was placed</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.catalog.get_aca_catalog">
<span class="sig-prename descclassname"><span class="pre">proseco.catalog.</span></span><span class="sig-name descname"><span class="pre">get_aca_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obsid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/catalog.html#get_aca_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.catalog.get_aca_catalog" title="Link to this definition">¶</a></dt>
<dd><p>Get a catalog of guide stars, acquisition stars and fid lights.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">obsid</span></code> is supplied and is a string, then it is taken to be starcheck
text with required info.  User-supplied kwargs take precedence, however
(e.g.  one can override the dither from starcheck).</p>
<p>In this situation if the <code class="docutils literal notranslate"><span class="pre">obsid</span></code> text includes the string
<code class="docutils literal notranslate"><span class="pre">--force-catalog</span></code> anywhere then the final proseco guide and acq catalogs
will be forced to match the input starcheck catalog.  This can be done by
appending this string, e.g. with <code class="docutils literal notranslate"><span class="pre">obs_text</span> <span class="pre">+</span> <span class="pre">'--force-catalog'</span></code> in the
call to <code class="docutils literal notranslate"><span class="pre">get_aca_catalog</span></code>.</p>
<p>The input <code class="docutils literal notranslate"><span class="pre">n_guide</span></code> parameter represents the number of slots available for
the combination of guide stars and monitor windows (including both fixed and
tracking monitor windows). In most normal situations, <code class="docutils literal notranslate"><span class="pre">n_guide</span></code> is equal
to <code class="docutils literal notranslate"><span class="pre">8</span> <span class="pre">-</span> <span class="pre">n_fid</span></code>. The <code class="docutils literal notranslate"><span class="pre">n_guide</span></code> parameter is confusingly named but this is
because the actual number of guide stars is not known in advance in the case
of auto-conversion from a monitor request to a guide star. In actual
practice, what is normally known is how many slots are available for the
combination of guide stars and monitor windows, so this makes the call to
catalog creation simpler.</p>
<p>NOTE on API:</p>
<p>Keywords that have <code class="docutils literal notranslate"><span class="pre">_acq</span></code> and/or <code class="docutils literal notranslate"><span class="pre">_guide</span></code> suffixes are handled with
the AliasAttribute in core.py.  If one calls get_aca_catalog() with e.g.
<code class="docutils literal notranslate"><span class="pre">t_ccd=-10</span></code> then that will set the CCD temperature for both acq and
guide selection.  This is not part of the public API but is a private
feature of the implementation that works for now.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obsid</strong> – obsid (int) or starcheck text (str) (default=0)</p></li>
<li><p><strong>att</strong> – attitude (any object that can initialize Quat)</p></li>
<li><p><strong>n_acq</strong> – desired number of acquisition stars (default=8)</p></li>
<li><p><strong>n_fid</strong> – desired number of fid lights (req’d unless obsid spec’d)</p></li>
<li><p><strong>n_guide</strong> – desired number of guide stars + monitor windows (req’d unless obsid spec’d)</p></li>
<li><p><strong>monitors</strong> – N x 5 float array specifying monitor windows</p></li>
<li><p><strong>man_angle</strong> – maneuver angle (deg)</p></li>
<li><p><strong>man_angle_next</strong> – maneuver angle to next attitude after this observation
(deg, default=180)</p></li>
<li><p><strong>t_ccd_acq</strong> – ACA CCD temperature for acquisition (degC)</p></li>
<li><p><strong>t_ccd_guide</strong> – ACA CCD temperature for guide (degC)</p></li>
<li><p><strong>t_ccd_penalty_limit</strong> – ACA CCD penalty limit for planning (degC). If not
provided this defaults to value from the ACA xija thermal model.</p></li>
<li><p><strong>t_ccd_eff_acq</strong> – ACA CCD effective temperature for acquisition (degC)</p></li>
<li><p><strong>t_ccd_eff_guide</strong> – ACA CCD effective temperature for guide (degC)</p></li>
<li><p><strong>dark</strong> – 1024x1024 dark image (e-/sec, default=None =&gt; auto-fetch)</p></li>
<li><p><strong>dark_date</strong> – Date of dark cal (str, optional)</p></li>
<li><p><strong>duration</strong> – duration of observation (sec)</p></li>
<li><p><strong>target_name</strong> – name of target (str)</p></li>
<li><p><strong>date</strong> – date of acquisition (any DateTime-compatible format)</p></li>
<li><p><strong>dither_acq</strong> – acq dither size (2-element sequence (y, z), arcsec)</p></li>
<li><p><strong>dither_guide</strong> – guide dither size (2-element sequence (y, z), arcsec)</p></li>
<li><p><strong>detector</strong> – ‘ACIS-S’ | ‘ACIS-I’ | ‘HRC-S’ | ‘HRC-I’</p></li>
<li><p><strong>sim_offset</strong> – SIM translation offset from nominal [steps] (default=0)</p></li>
<li><p><strong>focus_offset</strong> – SIM focus offset [steps] (default=0)</p></li>
<li><p><strong>target_offset</strong> – (y, z) target offset including dynamical offset
(2-element sequence (y, z), deg)</p></li>
<li><p><strong>dyn_bgd_n_faint</strong> – number of faint stars to apply the dynamic background
temperature bonus <code class="docutils literal notranslate"><span class="pre">dyn_bgd_dt_ccd</span></code> (default=2)</p></li>
<li><p><strong>dyn_bgd_dt_ccd</strong> – dynamic background T_ccd temperature bonus (default=-4.0, degC)</p></li>
<li><p><strong>stars</strong> – table of AGASC stars (will be fetched from agasc if None)</p></li>
<li><p><strong>include_ids_acq</strong> – list of AGASC IDs of stars to include in acq catalog</p></li>
<li><p><strong>include_halfws_acq</strong> – list of acq halfwidths corresponding to <code class="docutils literal notranslate"><span class="pre">include_ids</span></code>.
For values of <code class="docutils literal notranslate"><span class="pre">0</span></code> proseco chooses the best halfwidth(s).</p></li>
<li><p><strong>exclude_ids_acq</strong> – list of AGASC IDs of stars to exclude from acq catalog</p></li>
<li><p><strong>include_ids_fid</strong> – list of fiducial lights to include by index.  If no possible
sets of fids include the id, no fids will be selected.</p></li>
<li><p><strong>exclude_ids_fid</strong> – list of fiducial lights to exclude by index</p></li>
<li><p><strong>include_ids_guide</strong> – list of AGASC IDs of stars to include in guide catalog</p></li>
<li><p><strong>exclude_ids_guide</strong> – list of AGASC IDs of stars to exclude from guide catalog</p></li>
<li><p><strong>img_size_guide</strong> – readout window size for guide stars (6, 8, or <code class="docutils literal notranslate"><span class="pre">None</span></code>).
Default value: 8 for ER’s; PROSECO_OR_IMAGE_SIZE environment value if
if set, otherwise 8.</p></li>
<li><p><strong>optimize</strong> – optimize star catalog after initial selection (default=True)</p></li>
<li><p><strong>verbose</strong> – provide extra logging info (mostly calc_p_safe) (default=False)</p></li>
<li><p><strong>print_log</strong> – print the run log to stdout (default=False)</p></li>
<li><p><strong>raise_exc</strong> – raise exception if it occurs in processing (default=True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ACATable of stars and fids</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.catalog.get_effective_t_ccd">
<span class="sig-prename descclassname"><span class="pre">proseco.catalog.</span></span><span class="sig-name descname"><span class="pre">get_effective_t_ccd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_ccd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_ccd_penalty_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/catalog.html#get_effective_t_ccd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.catalog.get_effective_t_ccd" title="Link to this definition">¶</a></dt>
<dd><p>Return the effective T_ccd used for selection and catalog evaluation.</p>
<p>For details see Dynamic ACA limits in baby steps section in:
<a class="reference external" href="https://occweb.cfa.harvard.edu/twiki/bin/view/Aspect/StarWorkingGroupMeeting2019x02x13">https://occweb.cfa.harvard.edu/twiki/bin/view/Aspect/StarWorkingGroupMeeting2019x02x13</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_ccd</strong> – float
Actual (predicted) CCD temperature</p></li>
<li><p><strong>t_ccd_penalty_limit</strong> – float, None
ACA penalty limit to use (degC). Default = aca_t_ccd_penalty_limit from
proseco.characteristics.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>t_ccd_eff
Effective CCD temperature (degC) for use in star selection</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.catalog.merge_cats">
<span class="sig-prename descclassname"><span class="pre">proseco.catalog.</span></span><span class="sig-name descname"><span class="pre">merge_cats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/catalog.html#merge_cats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.catalog.merge_cats" title="Link to this definition">¶</a></dt>
<dd><p>Merge <code class="docutils literal notranslate"><span class="pre">fids</span></code>, <code class="docutils literal notranslate"><span class="pre">guides</span></code>, and <code class="docutils literal notranslate"><span class="pre">acqs</span></code> catalogs into one catalog.</p>
<p>The output of this function is a catalog which corresponds to the final
“flight” catalog that can be translated directly to appropriate OBC
spacecraft commanding, e.g. a DOT ACQ command. The ordering of entries
is intended to match the legacy behavior of MATLAB tools.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fids</strong> – FidTable, None (optional)
Table of fids</p></li>
<li><p><strong>guides</strong> – GuideTable, None (optional)
Table of guide stars</p></li>
<li><p><strong>acqs</strong> – AcqTable, None (optional)
Table of acquisition stars</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ACACatalogTable
Merged catalog</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-proseco.acq">
<span id="acquisition"></span><h2>Acquisition<a class="headerlink" href="#module-proseco.acq" title="Link to this heading">¶</a></h2>
<p>Get a catalog of acquisition stars using the algorithm described in
<a class="reference external" href="https://docs.google.com/presentation/d/1VtFKAW9he2vWIQAnb6unpK4u1bVAVziIdX9TnqRS3a8">https://docs.google.com/presentation/d/1VtFKAW9he2vWIQAnb6unpK4u1bVAVziIdX9TnqRS3a8</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="proseco.acq.AcqTable">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">proseco.acq.</span></span><span class="sig-name descname"><span class="pre">AcqTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable" title="Link to this definition">¶</a></dt>
<dd><p>Catalog of acquisition stars</p>
<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.calc_p_brightest">
<span class="sig-name descname"><span class="pre">calc_p_brightest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">man_err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bgd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.calc_p_brightest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.calc_p_brightest" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the probability that the <cite>acq</cite> star is the brightest
candidate in the search box.</p>
<p>This caches the spoiler and imposter stars in the acqs table (the row
corresponding to <code class="docutils literal notranslate"><span class="pre">acq</span></code>).  It is required that the first time this is
called that the box_size and man_err be the maximum, and this is checked.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acq</strong> – acq stars (AcqTable Row)</p></li>
<li><p><strong>box_size</strong> – box size (float, arcsec)</p></li>
<li><p><strong>man_err</strong> – maneuver error (float, arcsec, default=0)</p></li>
<li><p><strong>bgd</strong> – assume background for imposters (float, e-sec, default=0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>probability that acq is the brightest (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.calc_p_safe">
<span class="sig-name descname"><span class="pre">calc_p_safe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.calc_p_safe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.calc_p_safe" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the probability of a safing action resulting from failure
to acquire at least two (2) acquisition stars.</p>
<p>This uses the probability of 2 or fewer stars =&gt; “conservative” p_fail at this
man_err.  This uses 2 stars instead of 1 or fewer (which is the actual criteria
for a safing action).  This allows for one star to be dropped for reasons not
reflected in the acq model probability and makes the optimization dig a bit deeper
in to the catalog beyond the brightest stars.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>p_safe (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.empty">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.empty" title="Link to this definition">¶</a></dt>
<dd><p>Return a minimal ACACatalogTable which satisfies API requirements.  For AcqTable
it should have ‘id’ and ‘halfw’ columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>StarsTable of stars (empty)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.get_acq_candidates">
<span class="sig-name descname"><span class="pre">get_acq_candidates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_candidates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#proseco.core.StarsTable" title="proseco.core.StarsTable"><span class="pre">StarsTable</span></a></span></span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.get_acq_candidates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.get_acq_candidates" title="Link to this definition">¶</a></dt>
<dd><p>Get candidates for acquisition stars from <code class="docutils literal notranslate"><span class="pre">stars</span></code> table.</p>
<p>This allows for candidates right up to the useful part of the CCD.
The p_acq will be accordingly penalized.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stars</strong> – list of stars in the field</p></li>
<li><p><strong>max_candidates</strong> – maximum candidate acq stars</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Table of candidates, indices of rejected stars</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.get_box_sizes">
<span class="sig-name descname"><span class="pre">get_box_sizes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_acqs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.get_box_sizes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.get_box_sizes" title="Link to this definition">¶</a></dt>
<dd><p>Get the available box sizes for each cand_acq as all those with size &lt;= the
largest man_error with non-zero probability.  E.g. in the 5-20 deg man
angle bin the 80-100” row is 0.1 and the 100-120” row is 0.0.  So this
will will limit the box sizes to 60, 80, and 100.</p>
<p>An exception to the box size limit is for bright stars.  For stars
brighter than 8.0 mag (referenced to t_ccd=-10), the box size is
allowed to go up to at least 100 arcsec.  For stars brighter than 9.0
mag it can go up to at least 80 arcsec.  At these bright mags the
larger search boxes have no impact on acquisition probability.</p>
<p>This is particularly relevant to man_angle &lt; 5 deg, where the max
maneuver error is 60 arcsec.  In this case, bright stars can still have
80 or 100 arcsec boxes.  In the case of a creep-away observation where
the initial bias might be bad, this gives a bit more margin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cand_acqs</strong> – AcqTable of candidate acq stars</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of box-size arrays corresponding to cand_acqs table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.get_candidates_mask">
<span class="sig-name descname"><span class="pre">get_candidates_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.get_candidates_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.get_candidates_mask" title="Link to this definition">¶</a></dt>
<dd><p>Get base filter for acceptable candidates.</p>
<p>This does not include spatial filtering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stars</strong> – StarsTable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bool mask of acceptable stars</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.get_initial_catalog">
<span class="sig-name descname"><span class="pre">get_initial_catalog</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.get_initial_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.get_initial_catalog" title="Link to this definition">¶</a></dt>
<dd><p>Get the initial catalog of up to <code class="docutils literal notranslate"><span class="pre">n_acq</span></code> candidate acquisition stars.  This
updates the current AcqTable (self) in place to add selected stars.</p>
<p>TO DO: these should all just be taken from self</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand_acqs</strong> – AcqTable of candidate acquisition stars</p></li>
<li><p><strong>stars</strong> – StarsTable of stars in or near the ACA FOV</p></li>
<li><p><strong>dark</strong> – dark current image (ndarray, e-/sec)</p></li>
<li><p><strong>dither</strong> – dither (float, arcsec)</p></li>
<li><p><strong>t_ccd</strong> – CCD temperature (float, degC)</p></li>
<li><p><strong>date</strong> – observation date</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.get_log_p_2_or_fewer">
<span class="sig-name descname"><span class="pre">get_log_p_2_or_fewer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.get_log_p_2_or_fewer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.get_log_p_2_or_fewer" title="Link to this definition">¶</a></dt>
<dd><p>Return the starcheck acquisition merit function of the probability of
acquiring two or fewer stars.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>log10(probability) (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.get_obs_info">
<span class="sig-name descname"><span class="pre">get_obs_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.get_obs_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.get_obs_info" title="Link to this definition">¶</a></dt>
<dd><p>Convenience method to return the parts of meta that are needed
for test_common OBS_INFO.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict of observation information</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.get_overlap_penalties">
<span class="sig-name descname"><span class="pre">get_overlap_penalties</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.get_overlap_penalties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.get_overlap_penalties" title="Link to this definition">¶</a></dt>
<dd><p>Get the probability penalties for overlapping boxes.</p>
<p>This is returned as a multiplicative factor on the acquisition success
probability. No overlap penalty implies a value of 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of penalties (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.has_nearby_spoiler">
<span class="sig-name descname"><span class="pre">has_nearby_spoiler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.has_nearby_spoiler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.has_nearby_spoiler" title="Link to this definition">¶</a></dt>
<dd><p>Returns True if <code class="docutils literal notranslate"><span class="pre">acq</span></code> has a nearby star that could spoil acquisition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acq</strong> – AcqTable Row</p></li>
<li><p><strong>stars</strong> – StarsTable</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.in_bad_star_set">
<span class="sig-name descname"><span class="pre">in_bad_star_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.in_bad_star_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.in_bad_star_set" title="Link to this definition">¶</a></dt>
<dd><p>Returns True if <code class="docutils literal notranslate"><span class="pre">acq</span></code> is in the bad star set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>acq</strong> – AcqTable Row</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.make_report">
<span class="sig-name descname"><span class="pre">make_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rootdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.make_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.make_report" title="Link to this definition">¶</a></dt>
<dd><p>Make summary HTML report for acq selection process and outputs.</p>
<p>Output is in <code class="docutils literal notranslate"><span class="pre">&lt;rootdir&gt;/obs&lt;obsid&gt;/acq/index.html</span></code> plus related images
in that directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rootdir</strong> – root directory for outputs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.optimize_acq_halfw">
<span class="sig-name descname"><span class="pre">optimize_acq_halfw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_safe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.optimize_acq_halfw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.optimize_acq_halfw" title="Link to this definition">¶</a></dt>
<dd><p>Optimize the box size (halfw) for the acq star <code class="docutils literal notranslate"><span class="pre">idx</span></code> in the current acqs
table.  Assume current <code class="docutils literal notranslate"><span class="pre">p_safe</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> – acq star index</p></li>
<li><p><strong>p_safe</strong> – current value of p_safe</p></li>
<li><p><strong>verbose</strong> – include extra information in the run log</p></li>
</ul>
</dd>
<dt class="field-even">Returns improved, p_safe<span class="colon">:</span></dt>
<dd class="field-even"><p>whether p_safe was improved and the new value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.optimize_acqs_halfw">
<span class="sig-name descname"><span class="pre">optimize_acqs_halfw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.optimize_acqs_halfw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.optimize_acqs_halfw" title="Link to this definition">¶</a></dt>
<dd><p>Optimize the box_size (halfw) for the acq stars in the current catalog.
This cycles through each star and optimizes the box size for that star
using the <code class="docutils literal notranslate"><span class="pre">optimize_acq_halfw()</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> – include additional information in the run log</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.optimize_catalog">
<span class="sig-name descname"><span class="pre">optimize_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.optimize_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.optimize_catalog" title="Link to this definition">¶</a></dt>
<dd><p>Optimize the current acquisition catalog.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> – include additional information in the run log</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.process_include_ids">
<span class="sig-name descname"><span class="pre">process_include_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_acqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.process_include_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.process_include_ids" title="Link to this definition">¶</a></dt>
<dd><p>Ensure that the cand_acqs table has stars that were forced to be included.</p>
<p>Also do validation of include_ids and include_halfws.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand_acqs</strong> – candidate acquisition stars table</p></li>
<li><p><strong>stars</strong> – stars table</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.select_best_p_acqs">
<span class="sig-name descname"><span class="pre">select_best_p_acqs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_acqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_p_acq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acq_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_sizes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.select_best_p_acqs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.select_best_p_acqs" title="Link to this definition">¶</a></dt>
<dd><p>Find stars with the highest acquisition probability according to the
algorithm below.  <code class="docutils literal notranslate"><span class="pre">p_acqs</span></code> is the same-named column from candidate
acq stars and it contains a dict keyed by (box_size, man_err).  This
algorithm uses the assumption of man_err=box_size.</p>
<ul class="simple">
<li><p>Loop over box sizes in descending order (160, …, 60)</p></li>
<li><p>Sort in descending order the p_acqs corresponding to that box size
(where largest p_acqs come first)</p></li>
<li><p>Loop over the list and add any stars with p_acq &gt; min_p_acq to the
list of accepted stars.</p></li>
<li><p>If the list is <code class="docutils literal notranslate"><span class="pre">n_acq</span></code> long (completely catalog) then stop</p></li>
</ul>
<p>This function can be called multiple times with successively smaller
min_p_acq to fill out the catalog.  The acq_indices and box_sizes
arrays are appended in place in this process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand_acqs</strong> – AcqTable of candidate acquisition stars</p></li>
<li><p><strong>min_p_acq</strong> – minimum p_acq to include in this round (float)</p></li>
<li><p><strong>acq_indices</strong> – list of indices into cand_acqs of selected stars</p></li>
<li><p><strong>box_sizes</strong> – list of box sizes of selected stars</p></li>
<li><p><strong>force</strong> – force-include stars (default=False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.update_idxs_halfws">
<span class="sig-name descname"><span class="pre">update_idxs_halfws</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfws</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.update_idxs_halfws"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.update_idxs_halfws" title="Link to this definition">¶</a></dt>
<dd><p>Update the rows of self to match the specified <code class="docutils literal notranslate"><span class="pre">agasc_ids</span></code>
and half widths.  These two input lists must match the length
of self and correspond to stars in self.cand_acqs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agasc_ids</strong> – list of AGASC IDs</p></li>
<li><p><strong>halfws</strong> – list of search box half widths</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.acq.AcqTable.update_p_acq_column">
<span class="sig-name descname"><span class="pre">update_p_acq_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acqs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#AcqTable.update_p_acq_column"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.AcqTable.update_p_acq_column" title="Link to this definition">¶</a></dt>
<dd><p>Update (in-place) the marginalized acquisition probability column
‘p_acq’.  This is typically called after a change in catalog or
change in the fid set.  The acq[‘probs’].p_acq_marg() method will
pick up the new fid set.
:param acqs:
:param acqs:</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.acq.box_overlap">
<span class="sig-prename descclassname"><span class="pre">proseco.acq.</span></span><span class="sig-name descname"><span class="pre">box_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfw1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfw2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#box_overlap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.box_overlap" title="Link to this definition">¶</a></dt>
<dd><p>Return True if boxes overlap, False otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y1</strong> – y centroid of first box (float, arcsec)</p></li>
<li><p><strong>z1</strong> – z centroid of first box (float, arcsec)</p></li>
<li><p><strong>halfw1</strong> – half width of first box (float, arcsec)</p></li>
<li><p><strong>y2</strong> – y centroid of second box (float, arcsec)</p></li>
<li><p><strong>z2</strong> – z centroid of second box (float, arcsec)</p></li>
<li><p><strong>halfw2</strong> – half width of second box (float, arcsec)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if boxes overlap, False otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.acq.boxes_overlap">
<span class="sig-prename descclassname"><span class="pre">proseco.acq.</span></span><span class="sig-name descname"><span class="pre">boxes_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfw1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cand_acqs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#proseco.acq.AcqTable" title="proseco.acq.AcqTable"><span class="pre">AcqTable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">acq_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/proseco/acq.html#boxes_overlap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.boxes_overlap" title="Link to this definition">¶</a></dt>
<dd><p>Check if candidate new acq box overlaps with already selected acq boxes.</p>
<p>This checks for overlaps between the box defined by (y1, z1, halfw1) and the boxes
defined by the rows in <code class="docutils literal notranslate"><span class="pre">cand_acqs</span></code> (yang and zang) and <code class="docutils literal notranslate"><span class="pre">box_sizes</span></code> with indices
in <code class="docutils literal notranslate"><span class="pre">acq_indices</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y1</strong> – y centroid of first box (float, arcsec)</p></li>
<li><p><strong>z1</strong> – z centroid of first box (float, arcsec)</p></li>
<li><p><strong>halfw1</strong> – half width of first box (float, arcsec)</p></li>
<li><p><strong>cand_acqs</strong> – AcqTable of candidate acquisition stars</p></li>
<li><p><strong>box_sizes</strong> – list of box sizes of selected stars</p></li>
<li><p><strong>acq_indices</strong> – list of indices into cand_acqs of selected stars</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>AGASC ID of the first overlapping box, or 0 if no overlap</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.acq.calc_p_brightest_compare">
<span class="sig-prename descclassname"><span class="pre">proseco.acq.</span></span><span class="sig-name descname"><span class="pre">calc_p_brightest_compare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_errs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#calc_p_brightest_compare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.calc_p_brightest_compare" title="Link to this definition">¶</a></dt>
<dd><p>For given <code class="docutils literal notranslate"><span class="pre">acq</span></code> star and intruders mag, mag_err,
do the probability calculation to see if the acq star is brighter
than all of them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acq</strong> – acquisition star (AcqTable Row)</p></li>
<li><p><strong>mags</strong> – iterable of mags</p></li>
<li><p><strong>mag_errs</strong> – iterable of mag errors</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>probability that acq stars is brighter than all mags</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.acq.calc_p_on_ccd">
<span class="sig-prename descclassname"><span class="pre">proseco.acq.</span></span><span class="sig-name descname"><span class="pre">calc_p_on_ccd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#calc_p_on_ccd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.calc_p_on_ccd" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the probability that star and initial tracked readout box
are fully within the usable part of the CCD.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">box_size</span></code> here is not a search box size, it is normally
<code class="docutils literal notranslate"><span class="pre">man_err</span> <span class="pre">+</span> <span class="pre">dither</span></code> and reflects the size of the box where the star can
land on the CCD.  This is independent of the search box size, but does
assume that man_err &lt; search box size.  This is always valid because
this function only gets called in that case (otherwise p_acq is just
set to 0.0 in calc_p_safe.  Dither does not enter into the
<code class="docutils literal notranslate"><span class="pre">man_err</span> <span class="pre">&lt;</span> <span class="pre">search</span> <span class="pre">box</span> <span class="pre">size</span></code> relation because the OBC accounts for
dither when setting the search box position.</p>
<p>This uses a simplistic calculation which assumes that <code class="docutils literal notranslate"><span class="pre">p_on_ccd</span></code> is
just the fraction of box area that is within the effective usable portion
of the CCD.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>row</strong> – row coordinate of star (float)</p></li>
<li><p><strong>col</strong> – col coordinate of star (float)</p></li>
<li><p><strong>box_size</strong> – box size (ACABox)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>probability the star is on usable part of CCD (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.acq.filter_box_sizes_for_maxmag">
<span class="sig-prename descclassname"><span class="pre">proseco.acq.</span></span><span class="sig-name descname"><span class="pre">filter_box_sizes_for_maxmag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_ccd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/proseco/acq.html#filter_box_sizes_for_maxmag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.filter_box_sizes_for_maxmag" title="Link to this definition">¶</a></dt>
<dd><p>Filter the list of box sizes</p>
<p>First compute the smallest allowed value of MAXMAG for this star, which is
the star mag + 3 times the star mag error (clipped to be within 0.5 to 1.5
mag, nominal).</p>
<p>For each box size and t_ccd compute the MAXMAG that keeps the search hits
at exactly 50. Then keep the box sizes where MAXMAG is less than the star
minimum MAXMAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mag</strong> – star mag (float)</p></li>
<li><p><strong>mag_err</strong> – star mag error (float)</p></li>
<li><p><strong>box_sizes</strong> – ndarray of box sizes (float, arcsec)</p></li>
<li><p><strong>t_ccd</strong> – CCD temperature (float, C)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray of box sizes (float, arcsec)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.acq.get_acq_candidates_mask">
<span class="sig-prename descclassname"><span class="pre">proseco.acq.</span></span><span class="sig-name descname"><span class="pre">get_acq_candidates_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Table</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/proseco/acq.html#get_acq_candidates_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.get_acq_candidates_mask" title="Link to this definition">¶</a></dt>
<dd><p>Get filter on <code class="docutils literal notranslate"><span class="pre">stars</span></code> for acceptable acquisition star candidates.</p>
<p>This does not include spatial filtering.</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>stars<span class="classifier">Table</span></dt><dd><p>Table of stars</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>ok<span class="classifier">np.array of bool</span></dt><dd><p>Mask of acceptable stars</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.acq.get_acq_catalog">
<span class="sig-prename descclassname"><span class="pre">proseco.acq.</span></span><span class="sig-name descname"><span class="pre">get_acq_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obsid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#get_acq_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.get_acq_catalog" title="Link to this definition">¶</a></dt>
<dd><p>Get a catalog of acquisition stars using the algorithm described in
<a class="reference external" href="https://docs.google.com/presentation/d/1VtFKAW9he2vWIQAnb6unpK4u1bVAVziIdX9TnqRS3a8">https://docs.google.com/presentation/d/1VtFKAW9he2vWIQAnb6unpK4u1bVAVziIdX9TnqRS3a8</a></p>
<p>If <code class="docutils literal notranslate"><span class="pre">obsid</span></code> corresponds to an already-scheduled obsid then the parameters
<code class="docutils literal notranslate"><span class="pre">att</span></code>, <code class="docutils literal notranslate"><span class="pre">man_angle</span></code>, <code class="docutils literal notranslate"><span class="pre">t_ccd</span></code>, <code class="docutils literal notranslate"><span class="pre">date</span></code>, and <code class="docutils literal notranslate"><span class="pre">dither</span></code> will
be fetched via <code class="docutils literal notranslate"><span class="pre">mica.starcheck</span></code> if not explicitly provided here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obsid</strong> – obsid (default=0)</p></li>
<li><p><strong>att</strong> – attitude (any object that can initialize Quat)</p></li>
<li><p><strong>n_acq</strong> – desired number of acquisition stars (default=8)</p></li>
<li><p><strong>man_angle</strong> – maneuver angle (deg)</p></li>
<li><p><strong>t_ccd</strong> – ACA CCD temperature (degC)</p></li>
<li><p><strong>date</strong> – date of acquisition (any DateTime-compatible format)</p></li>
<li><p><strong>dither</strong> – dither size (float or 2-element sequence (dither_y, dither_z), arcsec)</p></li>
<li><p><strong>detector</strong> – ‘ACIS-S’ | ‘ACIS-I’ | ‘HRC-S’ | ‘HRC-I’</p></li>
<li><p><strong>sim_offset</strong> – SIM translation offset from nominal [steps] (default=0)</p></li>
<li><p><strong>focus_offset</strong> – SIM focus offset [steps] (default=0)</p></li>
<li><p><strong>stars</strong> – table of AGASC stars (will be fetched from agasc if None)</p></li>
<li><p><strong>include_ids</strong> – list of AGASC IDs of stars to include in selected catalog</p></li>
<li><p><strong>include_halfws</strong> – list of acq halfwidths corresponding to <code class="docutils literal notranslate"><span class="pre">include_ids</span></code>.
For values of <code class="docutils literal notranslate"><span class="pre">0</span></code> proseco chooses the best halfwidth(s).</p></li>
<li><p><strong>exclude_ids</strong> – list of AGASC IDs of stars to exclude from selected catalog</p></li>
<li><p><strong>optimize</strong> – optimize star catalog after initial selection (default=True)</p></li>
<li><p><strong>verbose</strong> – provide extra logging info (mostly calc_p_safe) (default=False)</p></li>
<li><p><strong>print_log</strong> – print the run log to stdout (default=False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>AcqTable of acquisition stars</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.acq.get_imposter_stars">
<span class="sig-prename descclassname"><span class="pre">proseco.acq.</span></span><span class="sig-name descname"><span class="pre">get_imposter_stars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dark</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">star_row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">star_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxmag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bgd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#get_imposter_stars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.get_imposter_stars" title="Link to this definition">¶</a></dt>
<dd><p>Note: current alg purposely avoids using the actual flight background
calculation because this is unstable to small fluctuations in values
and often over-estimates background.  Using this can easily miss a
search hit that the flight ACA will detect.  So just use a mean
dark current <code class="docutils literal notranslate"><span class="pre">bgd</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dark</strong> – dark current image (ndarray, e-/sec)</p></li>
<li><p><strong>star_row</strong> – row of acq star (float)</p></li>
<li><p><strong>star_col</strong> – col of acq star (float)</p></li>
<li><p><strong>thresh</strong> – PEA search hit threshold for a 2x2 block (e-/sec)</p></li>
<li><p><strong>maxmag</strong> – Max mag (alternate way to specify search hit <code class="docutils literal notranslate"><span class="pre">thresh</span></code>)</p></li>
<li><p><strong>box_size</strong> – box size (arcsec)</p></li>
<li><p><strong>bgd</strong> – assumed flat background (float, e-/sec)</p></li>
<li><p><strong>mag_limit</strong> – Max mag for imposter (using 6x6 readout)</p></li>
<li><p><strong>test</strong> – hook for convenience in algorithm testing</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy structured array of imposter stars</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.acq.get_intruders">
<span class="sig-prename descclassname"><span class="pre">proseco.acq.</span></span><span class="sig-name descname"><span class="pre">get_intruders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#get_intruders"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.get_intruders" title="Link to this definition">¶</a></dt>
<dd><p>Get intruders table for name=’spoilers’ or ‘imposters’ from <code class="docutils literal notranslate"><span class="pre">acq</span></code>.
If not already in acq then call <code class="docutils literal notranslate"><span class="pre">get_func(**kwargs)</span></code> to get it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acq</strong> – acq stars (AcqTable Row)</p></li>
<li><p><strong>box_size</strong> – box size (float, arcsec)</p></li>
<li><p><strong>name</strong> – intruder name (‘spoilers’ | ‘imposters’)</p></li>
<li><p><strong>n_sigma</strong> – sigma threshold for comparisons</p></li>
<li><p><strong>get_func</strong> – function to actually get spoilers or imposters</p></li>
<li><p><strong>kwargs</strong> – kwargs to pass to get_func()</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict with keys yang, zang, mag, mag_err.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.acq.get_maxmag">
<span class="sig-prename descclassname"><span class="pre">proseco.acq.</span></span><span class="sig-name descname"><span class="pre">get_maxmag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_ccd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></span><a class="reference internal" href="_modules/proseco/acq.html#get_maxmag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.get_maxmag" title="Link to this definition">¶</a></dt>
<dd><p>Get maxmag for given box_size and t_ccd.</p>
<p>This corresponds to the MAXMAG that results in exactly 50 search hits. See
<a class="reference external" href="https://occweb.cfa.harvard.edu/twiki/bin/view/Aspect/PeaMaxMagTesting">https://occweb.cfa.harvard.edu/twiki/bin/view/Aspect/PeaMaxMagTesting</a>.</p>
<p>Maxmag data made with analysis/interpolate-maxmags-contour-plot.ipynb.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box_size</strong> – box size (int, arcsec)</p></li>
<li><p><strong>t_ccd</strong> – CCD temperature (float, C)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>maxmag (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.acq.get_p_man_err">
<span class="sig-prename descclassname"><span class="pre">proseco.acq.</span></span><span class="sig-name descname"><span class="pre">get_p_man_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">man_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">man_angle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#get_p_man_err"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.get_p_man_err" title="Link to this definition">¶</a></dt>
<dd><p>Probability for given <code class="docutils literal notranslate"><span class="pre">man_err</span></code> given maneuver angle <code class="docutils literal notranslate"><span class="pre">man_angle</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>man_err</strong> – maneuver error (float, arcsec)</p></li>
<li><p><strong>man_angle</strong> – maneuver angle (float, deg)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>probability of man_error for given man_angle</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.acq.get_spoiler_stars">
<span class="sig-prename descclassname"><span class="pre">proseco.acq.</span></span><span class="sig-name descname"><span class="pre">get_spoiler_stars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/acq.html#get_spoiler_stars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.get_spoiler_stars" title="Link to this definition">¶</a></dt>
<dd><p>Get acq spoiler stars, i.e. any star in the specified box_size (which
would normally be an extended box including man_err).</p>
<p>OBC adjusts search box position based on the difference between estimated
and target attitude (which is the basis for yang/zang in catalog).  Dither
is included in the adjustment, so the only remaining term is the
maneuver error, which is included via the <code class="docutils literal notranslate"><span class="pre">man_err</span></code> box extension.
Imagine a 500 arcsec dither pattern.  OBC adjusts search box for that,
so apart from actual man err the box will be centered on the acq star.</p>
<p>See this ref for information on how well the catalog mag errors correlate
with observed.  Answer: not exactly, but probably good enough.  Plots all
the way at the bottom are key:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">nbviewer</span><span class="o">.</span><span class="n">jupyter</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">url</span><span class="o">/</span><span class="n">cxc</span><span class="o">.</span><span class="n">harvard</span><span class="o">.</span><span class="n">edu</span><span class="o">/</span><span class="n">mta</span><span class="o">/</span><span class="n">ASPECT</span><span class="o">/</span>
       <span class="n">ipynb</span><span class="o">/</span><span class="n">ssawg</span><span class="o">/</span><span class="mi">2018</span><span class="n">x03x21</span><span class="o">/</span><span class="n">star</span><span class="o">-</span><span class="n">mag</span><span class="o">-</span><span class="n">uncertainties</span><span class="o">.</span><span class="n">ipynb</span>
</pre></div>
</div>
<p>TO DO: consider mag uncertainties at the faint end related to
background subtraction and warm pixel corruption of background.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stars</strong> – StarsTable of stars for this field</p></li>
<li><p><strong>acq</strong> – acquisition star (AcqTable Row)</p></li>
<li><p><strong>box_size</strong> – box size (float, arcsec)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy structured array of spoiler stars</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.acq.load_maxmags">
<span class="sig-prename descclassname"><span class="pre">proseco.acq.</span></span><span class="sig-name descname"><span class="pre">load_maxmags</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="_modules/proseco/acq.html#load_maxmags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.acq.load_maxmags" title="Link to this definition">¶</a></dt>
<dd><p>Load maxmags from disk.</p>
<p>Maxmag data made with analysis/interpolate-maxmags-contour-plot.ipynb</p>
</dd></dl>

</section>
<section id="module-proseco.guide">
<span id="guide"></span><h2>Guide<a class="headerlink" href="#module-proseco.guide" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="proseco.guide.GuideTable">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">GuideTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable" title="Link to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.drop_excess_bonus_stars">
<span class="sig-name descname"><span class="pre">drop_excess_bonus_stars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">guides</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.drop_excess_bonus_stars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.drop_excess_bonus_stars" title="Link to this definition">¶</a></dt>
<dd><p>Drop excess dynamic background faint “bonus” stars if necessary.</p>
<p>For dyn bgd with dyn_bgd_n_faint &gt; 0, candidates fainter then the
nominal faint limit can be selected. However, only at most
dyn_bgd_n_faint of these bonus faint stars are allowed in the final
catalog (unless more are force-included).</p>
<p>This method removes faint bonus stars (in-place within <code class="docutils literal notranslate"><span class="pre">guides</span></code>) in
excess of the allowed dyn_bgd_n_faint number. It is assumed that the
catalog order is by star preference (‘stage’, ‘mag’), so bonus stars
that come first are kept.</p>
<p>Force included stars are not removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>guides</strong> – Table of guide stars</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.exclude_overlaps">
<span class="sig-name descname"><span class="pre">exclude_overlaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage_cands</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.exclude_overlaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.exclude_overlaps" title="Link to this definition">¶</a></dt>
<dd><p>Review the stars selected at any stage and exclude stars that overlap in
tracking space with another. Overlap is defined as being within 12 pixels.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.filter_candidates_for_fids">
<span class="sig-name descname"><span class="pre">filter_candidates_for_fids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_guides</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.filter_candidates_for_fids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.filter_candidates_for_fids" title="Link to this definition">¶</a></dt>
<dd><p>Filter candidate guide stars with regard to the selected fid lights.</p>
<p>This method removes guide star candidates that would spoil or be spoiled by
fid lights
1. Fid trap effect: candidates that trigger readout artifacts from fid lights
2. Direct spoiling: candidates too close to fid lights (within spoiler margin)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cand_guides</strong> – Table of candidate guide stars</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtered Table of candidate guide stars with spoiled stars removed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.filter_candidates_for_monitors">
<span class="sig-name descname"><span class="pre">filter_candidates_for_monitors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_guides</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.filter_candidates_for_monitors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.filter_candidates_for_monitors" title="Link to this definition">¶</a></dt>
<dd><p>Filter candidate guide stars that fall in monitor window keep-out zones.</p>
<p>This directly excludes candidates near MON_FIXED and MON_TRACK windows,
replacing the old approach of modifying the dark map.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.get_candidates_mask">
<span class="sig-name descname"><span class="pre">get_candidates_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.get_candidates_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.get_candidates_mask" title="Link to this definition">¶</a></dt>
<dd><p>Get base filter for acceptable candidates.</p>
<p>This does not include spatial filtering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stars</strong> – StarsTable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bool mask of acceptable stars</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.get_img_size">
<span class="sig-name descname"><span class="pre">get_img_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_fids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.get_img_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.get_img_size" title="Link to this definition">¶</a></dt>
<dd><p>Get guide image readout size from <code class="docutils literal notranslate"><span class="pre">img_size</span></code> and <code class="docutils literal notranslate"><span class="pre">n_fids</span></code>.</p>
<p>If img_size is None (typical case) then this uses the default rules
defined in <code class="docutils literal notranslate"><span class="pre">core.get_img_size()</span></code>, namely 8x8 for all guide stars
unless overridden by the PROSECO_OR_IMAGE_SIZE environment variable.</p>
<p>This requires that the <code class="docutils literal notranslate"><span class="pre">fids</span></code> attribute has been set, normally by
providing the table as an arg to <code class="docutils literal notranslate"><span class="pre">get_guide_catalog()</span></code>.</p>
<section id="id3">
<h3>Parameters<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>n_fids<span class="classifier">int or None</span></dt><dd><p>Number of fids in the catalog</p>
</dd>
</dl>
</section>
<section id="id4">
<h3>Returns<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>int</dt><dd><p>Guide star image readout size to be used in a catalog</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.get_initial_guide_candidates">
<span class="sig-name descname"><span class="pre">get_initial_guide_candidates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.get_initial_guide_candidates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.get_initial_guide_candidates" title="Link to this definition">¶</a></dt>
<dd><p>Create a candidate list from the available stars in the field.</p>
<p>As the initial list of candidates is created this:</p>
<p>1. Runs get_candidate_mask to limit the “ok” mask to the list of candidates to only those
that at least mee the minimum filter (based fields of the AGASC).</p>
<p>2. Sets the “ok” mask to limit to stars that are on the CCD (with minimum edge padding
but no dither padding)</p>
<p>3. Adds a column (‘offchip’) to the table of all stars to mark those that aren’t on the
CCD at all (offchip = True).</p>
<p>4. Makes one more position filter of the possible candidate stars that limits to those
stars that are on the CCD with edge minimum padding, readout window padding, and padding
for dither.</p>
<p>5. Filters the supplied star table (self.stars) using the filters in 1), 2) and 4), to
produce a candidate list.</p>
<ol class="arabic simple" start="6">
<li><p>Filters the candidate list to remove any that are spoiled by bad pixel.</p></li>
<li><p>Filters the candidate list to remove any that are in the bad stars list.</p></li>
</ol>
<p>8. Filters the candidates to remove any that have a spoiler in a NxN box centered
on the star brighter than M magnitudes fainter than the candidate (N is 5 and M is -4
from the box_spoiler section of guide characteristics).  This check uses the
<cite>has_spoiler_in_box</cite> method and is the first of many spoiler checks.  This spoiler
check is not stage dependent.</p>
<p>9. If Jupiter is present, filters the candidates to remove any that are within
15 columns of Jupiter.</p>
<p>10. Uses the local dark current around each candidate to calculate an “imposter mag”
describing the brightest 2x2 in the region the star would dither over.  This is
saved to the candidate star table.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.in_bad_star_list">
<span class="sig-name descname"><span class="pre">in_bad_star_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_guides</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.in_bad_star_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.in_bad_star_list" title="Link to this definition">¶</a></dt>
<dd><p>Mark star bad if candidate AGASC ID in bad star list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cand_guides</strong> – Table of candidate stars</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>boolean mask where True means star is in bad star list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.make_report">
<span class="sig-name descname"><span class="pre">make_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rootdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.make_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.make_report" title="Link to this definition">¶</a></dt>
<dd><p>Make summary HTML report for guide selection process and outputs.</p>
<p>Output is in <code class="docutils literal notranslate"><span class="pre">&lt;rootdir&gt;/obs&lt;obsid&gt;/guide/index.html</span></code> plus related images
in that directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rootdir</strong> – root directory for outputs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.process_exclude_ids">
<span class="sig-name descname"><span class="pre">process_exclude_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_guides</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.process_exclude_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.process_exclude_ids" title="Link to this definition">¶</a></dt>
<dd><p>Remove any stars from cand_guides that are in exclude_ids.</p>
<p>This works in-place on cand_guides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cand_guides</strong> – candidate guide stars table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.process_include_ids">
<span class="sig-name descname"><span class="pre">process_include_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_guides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.process_include_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.process_include_ids" title="Link to this definition">¶</a></dt>
<dd><p>Ensure that the cand_guides table has stars that were forced to be included.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand_guides</strong> – candidate guide stars table</p></li>
<li><p><strong>stars</strong> – stars table</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.process_monitors_post">
<span class="sig-name descname"><span class="pre">process_monitors_post</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.process_monitors_post"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.process_monitors_post" title="Link to this definition">¶</a></dt>
<dd><p>Post-processing of monitor windows.</p>
<ul class="simple">
<li><p>Set type, sz, res, dim columns for relevant entries to reflect
status as monitor or guide-from-monitor in the guides catalog.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.reject">
<span class="sig-name descname"><span class="pre">reject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reject</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.reject"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.reject" title="Link to this definition">¶</a></dt>
<dd><p>Add a reject dict to self.reject_info</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.run_search_stages">
<span class="sig-name descname"><span class="pre">run_search_stages</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.run_search_stages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.run_search_stages" title="Link to this definition">¶</a></dt>
<dd><p>Run search stages as necessary to select up to the requested number of guide stars.</p>
<p>This routine first force selects any guide stars supplied as <code class="docutils literal notranslate"><span class="pre">include_ids</span></code>, marking
these as selected in stage 0 in the ‘stage’ column in the candidate table, and then
runs search stages.</p>
<p>In each “search stage”, checks are run on each candidate to exclude candidates that
do not meet the selection criteria in the stage.  Candidates that satisfy the
stage requirements are marked with the allowed stage of selection (by its integer id)
in the ‘stage’ column in the candidate table.</p>
<p>The run_search_stages method loops over the search stages until at least the
<code class="docutils literal notranslate"><span class="pre">n_guide</span></code> requested stars are marked with a stage &gt;= 0 or until all stage checks have
been exhausted.  This run_search_stages routine then sorts the candidates by
selected stage and magnitude and returns up to the n requested guide stars as
the selected stars.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.search_stage">
<span class="sig-name descname"><span class="pre">search_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.search_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.search_stage" title="Link to this definition">¶</a></dt>
<dd><p>Review the candidates with the criteria defined in <code class="docutils literal notranslate"><span class="pre">stage</span></code> and return a mask that
marks the candidates that are “ok” for this search stage.  This is used to then
annotate the candidate table when called from run_search_stages to mark the stars that could
be selected in a stage.  As candidate stars are “rejected” in the stage, details
of that rejection are also added to self.reject_info .</p>
<p>Additionally, candidate stars that do not pass a check in the stage get their error
bitmask in ‘stat_{n_stage}’ marked up with the error.</p>
<p>Candidates are not removed from the tble in this routine; the length of the candidate
table should not change after get_initial_guide_candidates (called before this routine).
Instead, as mentioned, this routine marks up informational columns in the table and returns
a mask of the “ok” stars in the stage.</p>
<p><strong>Details</strong>:</p>
<p>In each stage, the dictionary of characteristics for the stage is used to run the checks to
see which candidates would be allowed. For example, the Stage 1 dictionary looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;Stage&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;SigErrMultiplier&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="s2">&quot;ASPQ1Lim&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">&quot;MagLimit&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.6</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">],</span>
  <span class="s2">&quot;DoBminusVcheck&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;Spoiler&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;BgPixThresh&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
   <span class="s2">&quot;RegionFrac&quot;</span><span class="p">:</span> <span class="mf">.05</span><span class="p">,</span>
   <span class="p">},</span>
  <span class="s2">&quot;Imposter&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;CentroidOffsetLim&quot;</span><span class="p">:</span> <span class="mf">.2</span><span class="p">,</span>
   <span class="p">}}</span>
</pre></div>
</div>
<p>In each stage these checks are run:</p>
<p>1. Candidate star magnitude is checked to see if it is within the range plus error.
For stage 1 for example , each candidate star is checked to see if it is within the
5.6 to 10.2 mag range, minus padding for error (SigErrMultiplier * cand[‘mag_err’]).</p>
<ol class="arabic simple" start="2">
<li><p>Candidates with ASPQ1 &gt; stage ASPQ1Lim are marked for exclusion.</p></li>
</ol>
<p>3. Candidates with local dark current that suggests that the candidate centroid could
be shifted more that CentroidOffsetLim (in arcsecs) are marked for exclusion.  The value of
the local dark current was previously saved during “get_initial_guide_candidates” as
“imp_mag”.</p>
<p>4. check_mag_spoilers is used to mark candidate stars that have spoilers that are too
close for the magnitude delta to the candidate as defined by the “line” used by that check.
The “line” basically works as a check that requires a minimum position separation for
a delta magnitude.  A candidate star with a spoiler of the same magnitude would require
that spoiler star to be Intercept (9 pixels) away.  A candidate star with a spoiler with
no separation would require the spoiler to be 18 mags fainter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">9</span> <span class="n">pixels</span> <span class="o">+</span>
<span class="p">(</span><span class="n">cand</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">spoiler</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">SigErrMultiplier</span> <span class="o">*</span> <span class="n">mag_err_sum</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="n">pix</span> <span class="o">/</span> <span class="n">dmag</span><span class="p">)</span>
</pre></div>
</div>
<p>The parameters of the check are not stage dependent, but the mag err there is defined as
SigErrMultiplier * mag_err_sum (MAG_ACA_ERR of candidate and spoiler added in quadrature).</p>
<p>5. check_spoil_contrib is used to mark candidate stars that have spoilers that contribute
too much light onto either the the 8x8 image window or to the 8 background pixels.  “Too
much” is defined by the Spoiler parameters of the stage, where in stage 1 a candidate
star will be excluded if either:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>the sum of the light from spoiler stars in the 8x8 contribute more than</dt><dd><p>(candidate star magnitude in counts) * (RegionFrac).</p>
</dd>
</dl>
</li>
<li><p>the sum of the light from spoiler stars on any background pixel is greater
that the BgPixThresh percentile of the current dark current.</p></li>
</ul>
</div></blockquote>
<p>6. check_column_spoilers marks candidates for exclusion if they have column spoilers
defined as spoilers between the candidate and the readout register, within
characterstics.col_spoiler_pix_sep (10 columns), and 4.5 mags brighter (minus error)
than the candidate.  The error is the stage-dependent term where it is set as
SigErrMultiplier * (the candidate MAG_ACA_ERR and the spoiler MAG_ACA_ERR added in
quadrature).</p>
<p>7. Candidates are then screened for “bad” color (COLOR1 == 0.700) if DoBMinusVCheck
is set for the stage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stage</strong> – dictionary of search stage parameters</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bool mask of the length of self.meta.cand_guides with true set for “ok” stars</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.guide.GuideTable.select_catalog">
<span class="sig-name descname"><span class="pre">select_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage_cands</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#GuideTable.select_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.GuideTable.select_catalog" title="Link to this definition">¶</a></dt>
<dd><p>Select a catalog from the candidates.</p>
<p>For the candidates selected at any stage, select the first combination that satisfies
either all of the additional checks or the most checks.  The checks are manually weighted
so that the jupiter check is weighted more heavily than the cluster checks (but
the jupiter check only applies if jupiter is present).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stage_cands</strong> – Table of stage-selected candidates</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.check_column_spoilers">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">check_column_spoilers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ok</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#check_column_spoilers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.check_column_spoilers" title="Link to this definition">¶</a></dt>
<dd><p>For each candidate, check for stars ‘MagDiff’ brighter and within ‘Separation’ columns
between the star and the readout register, i.e. Column Spoilers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand_stars</strong> – Table of candidate stars</p></li>
<li><p><strong>ok</strong> – mask on cand_stars describing still “ok” candidates</p></li>
<li><p><strong>stars</strong> – Table of AGASC stars</p></li>
<li><p><strong>n_sigma</strong> – multiplier used when checking mag with MAG_ACA_ERR</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bool mask on cand_stars marking column spoiled stars, list of debug reject dicts</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.check_fid_trap">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">check_fid_trap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dither</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#check_fid_trap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.check_fid_trap" title="Link to this definition">¶</a></dt>
<dd><p>Search for guide stars that would cause the fid trap issue and mark as spoilers.</p>
<p>The “fid trap” issue is documented at <a class="reference external" href="https://cxc.cfa.harvard.edu/mta/ASPECT/aca_weird_pixels/">https://cxc.cfa.harvard.edu/mta/ASPECT/aca_weird_pixels/</a> .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand_stars</strong> – candidate star Table</p></li>
<li><p><strong>fids</strong> – fid Table</p></li>
<li><p><strong>dither</strong> – dither ACABox</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>mask on cand_stars of fid trap spoiled stars, list of rejection info dicts</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.check_mag_spoilers">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">check_mag_spoilers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ok</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#check_mag_spoilers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.check_mag_spoilers" title="Link to this definition">¶</a></dt>
<dd><p>Use the slope-intercept mag-spoiler relationship to exclude all
stars that have a “mag spoiler”.  This is basically equivalent to the
“direct catalog search” for spoilers in SAUSAGE, but does not forbid
all stars within 7 pixels (spoilers must be faint to be close).</p>
<p>The n-sigma changes by stage for the mags/magerrs used in the check.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand_stars</strong> – Table of candidate stars</p></li>
<li><p><strong>ok</strong> – mask on cand_stars describing those that are still “ok”</p></li>
<li><p><strong>stars</strong> – Table of AGASC stars in this field</p></li>
<li><p><strong>n_sigma</strong> – multiplier use for MAG_ACA_ERR when reviewing spoilers</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bool mask of length cand_stars marking mag_spoiled stars, list of reject debug dicts</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.check_single_cluster">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">check_single_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_guide_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_minus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#check_single_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.check_single_cluster" title="Link to this definition">¶</a></dt>
<dd><p>Confirm that a set of stars satisfies the minimum separation threshold when n_minus
stars are removed from the set.  For example, for a threshold of 1000, n_minus of 1,
and an input set of candidates stars with 5 candidates, confirm that, for any 4 of
the 5 stars (5 minus n_minus = 1), one pair of those stars is separated by at
least 1000 arcsecs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool (True for check passing threshold)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.check_spoil_contrib">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">check_spoil_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ok</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regfrac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bgthresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#check_spoil_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.check_spoil_contrib" title="Link to this definition">¶</a></dt>
<dd><p>Check that there are no spoiler stars contributing more than a fraction
of the candidate star to the candidate star’s 8x8 pixel region or more than bgthresh
to any of the background pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand_stars</strong> – candidate star Table</p></li>
<li><p><strong>ok</strong> – mask on cand_stars of candidates that are still ‘ok’</p></li>
<li><p><strong>stars</strong> – Table of agasc stars for this field</p></li>
<li><p><strong>regfrac</strong> – fraction of candidate star mag that may fall on the 8x8 due to spoilers
A sum above this fraction will mark the cand_star as spoiled</p></li>
<li><p><strong>bgthresh</strong> – background pixel threshold (in e-/sec).  If spoilers contribute more
than this value to any background pixel, mark the cand_star as spoiled.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>reg_spoiled, bg_spoiled, rej - two masks on cand_stars and a list of reject
debug dicts</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.dist2">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">dist2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#dist2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.dist2" title="Link to this definition">¶</a></dt>
<dd><p>Calculate squared distance between a pair of stars in a star table.</p>
<p>This local version of the method uses a cache.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.get_ax_range">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">get_ax_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extent</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#get_ax_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.get_ax_range" title="Link to this definition">¶</a></dt>
<dd><p>Given a float pixel row or col value and an “extent” in float pixels,
generally 4 + 1.6 for 8” dither and 4 + 5.0 for 20” dither,
return a range for the row or col that is divisible by 2 and contains
at least the requested extent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rc</strong> – row or col float value (edge pixel coords)</p></li>
<li><p><strong>extent</strong> – half of desired range from n (should include pixel dither)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of range as (minus, plus)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.get_guide_candidates">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">get_guide_candidates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obsid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#get_guide_candidates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.get_guide_candidates" title="Link to this definition">¶</a></dt>
<dd><p>Get initial guide star candidates.</p>
<p>This function creates a GuideTable and performs the initial filtering
to generate candidate guide stars. The returned Table can be reused
across multiple calls to get_guide_catalog() during optimization by
passing a copy (via .copy()) to prevent modification.</p>
<p>This explicitly ignores fid lights and monitor windows requests; these
considerations are handled later in get_guide_catalog().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obsid</strong> – obsid (default=0)</p></li>
<li><p><strong>att</strong> – attitude (any object that can initialize Quat)</p></li>
<li><p><strong>t_ccd</strong> – ACA CCD temperature (degC)</p></li>
<li><p><strong>date</strong> – date of acquisition (any DateTime-compatible format)</p></li>
<li><p><strong>dither</strong> – dither size (float or 2-element sequence (dither_y, dither_z), arcsec)</p></li>
<li><p><strong>stars</strong> – astropy.Table of AGASC stars (will be fetched from agasc if None)</p></li>
<li><p><strong>dark</strong> – ACAImage of dark map (fetched based on time and t_ccd if None)</p></li>
<li><p><strong>**kwargs</strong> – <p>additional keyword arguments passed to GuideTable</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Astropy Table of initial guide candidates</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.get_guide_candidates_mask">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">get_guide_candidates_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_ccd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dyn_bgd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/proseco/guide.html#get_guide_candidates_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.get_guide_candidates_mask" title="Link to this definition">¶</a></dt>
<dd><p>Get filter on <code class="docutils literal notranslate"><span class="pre">stars</span></code> for acceptable guide candidates.</p>
<p>This does not include spatial filtering.</p>
<section id="id7">
<h3>Parameters<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>stars<span class="classifier">Table</span></dt><dd><p>Table of stars</p>
</dd>
<dt>t_ccd<span class="classifier">float</span></dt><dd><p>ACA CCD temperature (degC)</p>
</dd>
<dt>dyn_bgd<span class="classifier">bool</span></dt><dd><p>Dynamic background enabled flag</p>
</dd>
</dl>
</section>
<section id="id8">
<h3>Returns<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>ok<span class="classifier">np.array of bool</span></dt><dd><p>Mask of acceptable stars</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.get_guide_catalog">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">get_guide_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obsid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_guide_cands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#get_guide_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.get_guide_catalog" title="Link to this definition">¶</a></dt>
<dd><p>Get a catalog of guide stars</p>
<p>If <code class="docutils literal notranslate"><span class="pre">obsid</span></code> corresponds to an already-scheduled obsid then the parameters
<code class="docutils literal notranslate"><span class="pre">att</span></code>, <code class="docutils literal notranslate"><span class="pre">t_ccd</span></code>, <code class="docutils literal notranslate"><span class="pre">date</span></code>, and <code class="docutils literal notranslate"><span class="pre">dither</span></code> will
be fetched via <code class="docutils literal notranslate"><span class="pre">mica.starcheck</span></code> if not explicitly provided here.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">initial_guide_cands</span></code> is provided as an argument, it is assumed to be a
Table of initial guide candidates (typically from get_guide_candidates().copy()).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obsid</strong> – obsid (default=0)</p></li>
<li><p><strong>att</strong> – attitude (any object that can initialize Quat)</p></li>
<li><p><strong>t_ccd</strong> – ACA CCD temperature (degC)</p></li>
<li><p><strong>date</strong> – date of acquisition (any DateTime-compatible format)</p></li>
<li><p><strong>dither</strong> – dither size 2-element tuple: (dither_y, dither_z) (float, arcsec)</p></li>
<li><p><strong>n_guide</strong> – number of guide stars to attempt to get</p></li>
<li><p><strong>fids</strong> – selected fids (used for guide star exclusion)</p></li>
<li><p><strong>stars</strong> – astropy.Table of AGASC stars (will be fetched from agasc if None)</p></li>
<li><p><strong>initial_guide_cands</strong> – Astropy Table of initial guide candidates
(if None, a new one is created)</p></li>
<li><p><strong>include_ids</strong> – list of AGASC IDs of stars to include in guide catalog</p></li>
<li><p><strong>exclude_ids</strong> – list of AGASC IDs of stars to exclude from guide catalog</p></li>
<li><p><strong>dark</strong> – ACAImage of dark map (fetched based on time and t_ccd if None)</p></li>
<li><p><strong>print_log</strong> – print the run log to stdout (default=False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>GuideTable of acquisition stars</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.get_imposter_mags">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">get_imposter_mags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dark</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dither</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#get_imposter_mags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.get_imposter_mags" title="Link to this definition">¶</a></dt>
<dd><p>Get “pseudo-mag” of max pixel value in each candidate star region</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand_stars</strong> – Table of candidate stars</p></li>
<li><p><strong>dark</strong> – full CCD dark map</p></li>
<li><p><strong>dither</strong> – observation dither to be used to determine pixels a star could use</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>np.array pixmags, np.array pix_r, np.array pix_c all of length cand_stars</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.get_pixmag_for_offset">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">get_pixmag_for_offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#get_pixmag_for_offset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.get_pixmag_for_offset" title="Link to this definition">¶</a></dt>
<dd><p>Determine the magnitude an individual bad pixel would need to spoil the centroid of
the candidate star by <code class="docutils literal notranslate"><span class="pre">offset</span></code>.  This just constructs the worst case as the bad pixel
3 pixels away (edge of box).  The offset in this case would be
offset = spoil_cnts * 3 * 5 / (spoil_cnts + cand_counts), where 3 is the distance to
the edge pixel in pixels and 5 is the conversion to arcsec.
Solving for spoil_cnts gives:
spoil_cnts = mag_to_count_rate(cand_mag) * (offset / (15 - offset))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand_mag</strong> – candidate star magnitude</p></li>
<li><p><strong>offset</strong> – centroid offset in arcsec</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>‘magnitude’ of bad pixel needed to for offset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.get_t_ccds_bonus">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">get_t_ccds_bonus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_ccd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dyn_bgd_n_faint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dyn_bgd_dt_ccd</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#get_t_ccds_bonus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.get_t_ccds_bonus" title="Link to this definition">¶</a></dt>
<dd><p>Return array of t_ccds with dynamic background bonus applied.</p>
<p>This adds <code class="docutils literal notranslate"><span class="pre">dyn_bgd_dt_ccd</span></code> to the effective CCD temperature for the
<code class="docutils literal notranslate"><span class="pre">dyn_bgd_n_faint</span></code> faintest stars, ensuring that at least MIN_DYN_BGD_ANCHOR_STARS
are evaluated without the bonus. See:
<a class="reference external" href="https://nbviewer.org/urls/cxc.harvard.edu/mta/ASPECT/ipynb/misc/guide-count-dyn-bgd.ipynb">https://nbviewer.org/urls/cxc.harvard.edu/mta/ASPECT/ipynb/misc/guide-count-dyn-bgd.ipynb</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mags</strong> – array of star magnitudes</p></li>
<li><p><strong>t_ccd</strong> – single T_ccd value (degC)</p></li>
<li><p><strong>dyn_bgd_n_faint</strong> – number of faintest stars to apply bonus</p></li>
<li><p><strong>dyn_bgd_dt_ccd</strong> – temperature offset to apply for dynamic background bonus (degC)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of t_ccds (matching <code class="docutils literal notranslate"><span class="pre">mags</span></code>) with dynamic background bonus applied</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.has_spoiler_in_box">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">has_spoiler_in_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_guides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfbox</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magdiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#has_spoiler_in_box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.has_spoiler_in_box" title="Link to this definition">¶</a></dt>
<dd><p>Check each candidate star for spoilers that would fall in a box centered on the star.
Mark candidate spoiled if there’s a spoiler in the box and brighter than magdiff fainter
than the candidate’s mag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand_guides</strong> – Table of candidate stars</p></li>
<li><p><strong>stars</strong> – Table of AGASC stars in the field</p></li>
<li><p><strong>halfbox</strong> – half of the length of a side of the box used for check (pixels)</p></li>
<li><p><strong>magdiff</strong> – magnitude difference threshold</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>mask on cand_guides set to True if star spoiled by another star in the pixel box,
and a list of dicts with reject debug info</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.run_cluster_checks">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">run_cluster_checks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_guide_set</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#run_cluster_checks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.run_cluster_checks" title="Link to this definition">¶</a></dt>
<dd><p>Perform cluster checks on a combination of candidate guide stars.</p>
<p>This performs a set of specific cluster checks on the provided cand_guide_set
and returns a list of bools, one for each cluster check run.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of bools, one for each cluster check run</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.guide.spoiled_by_bad_pixel">
<span class="sig-prename descclassname"><span class="pre">proseco.guide.</span></span><span class="sig-name descname"><span class="pre">spoiled_by_bad_pixel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_guides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dither</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/guide.html#spoiled_by_bad_pixel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.guide.spoiled_by_bad_pixel" title="Link to this definition">¶</a></dt>
<dd><p>Mark star bad if spoiled by a bad pixel in the bad pixel list (not hot)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand_guides</strong> – Table of candidate stars</p></li>
<li><p><strong>dither</strong> – dither ACABox</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>boolean mask on cand_guides where True means star is spoiled by bad pixel,
list of dicts of reject debug info</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-proseco.fid">
<span id="fid"></span><h2>Fid<a class="headerlink" href="#module-proseco.fid" title="Link to this heading">¶</a></h2>
<p>Get a catalog of fid lights.</p>
<dl class="py class">
<dt class="sig sig-object py" id="proseco.fid.FidTable">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">proseco.fid.</span></span><span class="sig-name descname"><span class="pre">FidTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/fid.html#FidTable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.fid.FidTable" title="Link to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="proseco.fid.FidTable.get_cand_fid_sets">
<span class="sig-name descname"><span class="pre">get_cand_fid_sets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/fid.html#FidTable.get_cand_fid_sets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.fid.FidTable.get_cand_fid_sets" title="Link to this definition">¶</a></dt>
<dd><p>Get a list of candidate fid-sets that can be selected given the list
of candidate fids that are available.  It also ensure that the fid sets
are compatible with the specified n_fid.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.fid.FidTable.get_fid_candidates">
<span class="sig-name descname"><span class="pre">get_fid_candidates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/fid.html#FidTable.get_fid_candidates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.fid.FidTable.get_fid_candidates" title="Link to this definition">¶</a></dt>
<dd><p>Get all fids for this detector that are on the CCD (with margin) and are not
impacted by a bad pixel.</p>
<p>This also finds fid spoiler stars and computes the spoiler_score.</p>
<p>Result is updating self.cand_fids.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.fid.FidTable.is_excluded">
<span class="sig-name descname"><span class="pre">is_excluded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/fid.html#FidTable.is_excluded"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.fid.FidTable.is_excluded" title="Link to this definition">¶</a></dt>
<dd><p>Return True if fid id is in exclude_ids_fid manual list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fid</strong> – FidTable Row of candidate fid light</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.fid.FidTable.near_hot_or_bad_pixel">
<span class="sig-name descname"><span class="pre">near_hot_or_bad_pixel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/fid.html#FidTable.near_hot_or_bad_pixel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.fid.FidTable.near_hot_or_bad_pixel" title="Link to this definition">¶</a></dt>
<dd><p>Return True if fid has a bad pixel too close</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fid</strong> – FidTable Row of candidate fid light</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.fid.FidTable.off_ccd">
<span class="sig-name descname"><span class="pre">off_ccd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/fid.html#FidTable.off_ccd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.fid.FidTable.off_ccd" title="Link to this definition">¶</a></dt>
<dd><p>Return True if <code class="docutils literal notranslate"><span class="pre">fid</span></code> is outside allowed CCD region.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fid</strong> – FidTable Row of candidate fid</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.fid.FidTable.set_initial_catalog">
<span class="sig-name descname"><span class="pre">set_initial_catalog</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/fid.html#FidTable.set_initial_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.fid.FidTable.set_initial_catalog" title="Link to this definition">¶</a></dt>
<dd><p>Set initial fid catalog (fid set) if possible to the first set which is
“perfect”:</p>
<ul class="simple">
<li><p>No field stars spoil any of the fid lights</p></li>
<li><p>Fid lights are not search spoilers for any of the current acq stars</p></li>
<li><p>The fid set does not include any fid lights in the trap region if there</p></li>
</ul>
<p>are guide candidates that would trigger the fid trap effect.</p>
<p>If not possible then the table is still zero length and we will need to
fall through to the optimization process.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.fid.FidTable.set_slot_column">
<span class="sig-name descname"><span class="pre">set_slot_column</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/fid.html#FidTable.set_slot_column"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.fid.FidTable.set_slot_column" title="Link to this definition">¶</a></dt>
<dd><p>Set the <cite>slot</cite> column.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.fid.FidTable.set_spoilers_score">
<span class="sig-name descname"><span class="pre">set_spoilers_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/fid.html#FidTable.set_spoilers_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.fid.FidTable.set_spoilers_score" title="Link to this definition">¶</a></dt>
<dd><p>Get stars within FID.spoiler_margin (50 arcsec) + dither and check for fid trap.</p>
<p>Starcheck uses 25” but this seems small: 20” (4 pix) positional err + 4 pixel
readout halfw + 2 pixel PSF width of spoiler star.</p>
<p>This sets the ‘spoilers’ column value to a table of spoilers stars (usually empty).</p>
<p>It also sets the ‘spoiler_score’ based on:
- 1 for yellow spoiler (4 &lt;= star_mag - fid_mag &lt; 5)
- 4 for red spoiler (star_mag - fid_mag &lt; 4)</p>
<p>Additionally, if the fid is in the fid_trap region and there is a potential guide
candidate that would trigger the fid trap effect, the ‘fid_trap_spoiler’ flag is set.</p>
<p>See  <a class="reference external" href="https://cxc.cfa.harvard.edu/mta/ASPECT/aca_weird_pixels/">https://cxc.cfa.harvard.edu/mta/ASPECT/aca_weird_pixels/</a> for more information on the
“fid trap” issue.</p>
<p>The spoiler score is used later to choose an acceptable set of fids and acq stars.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fid</strong> – fid light (FidTable Row)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.fid.FidTable.spoils">
<span class="sig-name descname"><span class="pre">spoils</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">star</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dither</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/fid.html#FidTable.spoils"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.fid.FidTable.spoils" title="Link to this definition">¶</a></dt>
<dd><p>Return true if <code class="docutils literal notranslate"><span class="pre">fid</span></code> could be within <code class="docutils literal notranslate"><span class="pre">acq</span></code> search box.</p>
<p>Includes:
- 20” (4 pix) positional err on fid light
- 4 pixel readout halfw for fid light
- 2 pixel PSF of fid light that could creep into search box
- Acq search box half-width
- Dither amplitude (since OBC adjusts search box for dither)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fid</strong> – fid light (FidTable Row)</p></li>
<li><p><strong>star</strong> – star (AcqTable Row or GuideTable Row)</p></li>
<li><p><strong>box_size</strong> – box size (arcsec)</p></li>
<li><p><strong>dither</strong> – dither size (ACABox, arcsec)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if <code class="docutils literal notranslate"><span class="pre">fid</span></code> could be within <code class="docutils literal notranslate"><span class="pre">star</span></code> search box</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.fid.get_fid_catalog">
<span class="sig-prename descclassname"><span class="pre">proseco.fid.</span></span><span class="sig-name descname"><span class="pre">get_fid_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obsid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/fid.html#get_fid_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.fid.get_fid_catalog" title="Link to this definition">¶</a></dt>
<dd><p>Get a catalog of fid lights.</p>
<p>This is the initial selection and only returns a catalog that is “perfect”:</p>
<ul class="simple">
<li><p>No fids are spoiled by a star</p></li>
<li><p>No fids spoil an acq star (via <code class="docutils literal notranslate"><span class="pre">acqs</span></code>)</p></li>
</ul>
<p>If no such fid catalog is available this function returns a zero-length
FidTable.  In this case a subsequent concurrent optimization of fid lights
and acq stars is peformed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detector</strong> – ‘ACIS-S’ | ‘ACIS-I’ | ‘HRC-S’ | ‘HRC-I’</p></li>
<li><p><strong>focus_offset</strong> – SIM focus offset [steps] (default=0)</p></li>
<li><p><strong>sim_offset</strong> – SIM translation offset from nominal [steps] (default=0)</p></li>
<li><p><strong>acqs</strong> – AcqTable catalog.  Optional but needed for actual fid selection.</p></li>
<li><p><strong>guide_cands</strong> – Table of initial guide candidates (used for star spoilers)</p></li>
<li><p><strong>stars</strong> – stars table.  Defaults to acqs.stars if available.</p></li>
<li><p><strong>dither_acq</strong> – acq dither size (2-element sequence (y, z), arcsec)</p></li>
<li><p><strong>dither_guide</strong> – guide dither size (2-element sequence (y, z), arcsec)</p></li>
<li><p><strong>include_ids</strong> – fid ids to force include. If no possible sets of fids include
the id (aka index), no fids will be selected.</p></li>
<li><p><strong>exclude_ids</strong> – fid ids to exclude</p></li>
<li><p><strong>n_fid</strong> – number of desired fid lights</p></li>
<li><p><strong>print_log</strong> – print log to stdout (default=False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>fid catalog (FidTable)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.fid.get_fid_positions">
<span class="sig-prename descclassname"><span class="pre">proseco.fid.</span></span><span class="sig-name descname"><span class="pre">get_fid_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">focus_offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_ccd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CxoTime</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Buffer" title="(in Python v3.14)"><span class="pre">Buffer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><span class="pre">complex</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><span class="pre">complex</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a></span></span><a class="reference internal" href="_modules/proseco/fid.html#get_fid_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.fid.get_fid_positions" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the fid light positions for all fids for <code class="docutils literal notranslate"><span class="pre">detector</span></code>.</p>
<p>This is adapted from the Matlab
<a class="reference external" href="mailto:MissionScheduling/stars/StarSelector/&#37;&#52;&#48;StarSelector/private/fidPositions&#46;m">MissionScheduling/stars/StarSelector/<span>&#64;</span>StarSelector/private/fidPositions<span>&#46;</span>m</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">Convert</span> <span class="n">focus</span> <span class="n">steps</span> <span class="n">to</span> <span class="n">meters</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">characteristics</span><span class="o">.</span><span class="n">Science</span><span class="o">.</span><span class="n">Sim</span><span class="o">.</span><span class="n">focus_table</span><span class="p">;</span>
<span class="n">xshift</span> <span class="o">=</span> <span class="n">interp1</span><span class="p">(</span><span class="n">table</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">table</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span><span class="n">focus</span><span class="p">,</span><span class="s1">&#39;*linear&#39;</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">xshift</span><span class="p">))</span>
    <span class="n">error</span><span class="p">(</span><span class="s1">&#39;Focus is out of range&#39;</span><span class="p">);</span>
<span class="n">end</span>

<span class="o">%</span><span class="n">find</span> <span class="n">translation</span> <span class="kn">from</span><span class="w"> </span><span class="nn">sim</span> <span class="n">offset</span>
<span class="n">stepsize</span> <span class="o">=</span> <span class="n">characteristics</span><span class="o">.</span><span class="n">Science</span><span class="o">.</span><span class="n">Sim</span><span class="o">.</span><span class="n">stepsize</span><span class="p">;</span>
<span class="n">zshift</span> <span class="o">=</span> <span class="n">SIfield</span><span class="o">.</span><span class="n">fidpos</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">simoffset</span><span class="o">*</span><span class="n">stepsize</span><span class="p">;</span>

<span class="n">yfid</span><span class="o">=-</span><span class="n">SIfield</span><span class="o">.</span><span class="n">fidpos</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">SIfield</span><span class="o">.</span><span class="n">focallength</span><span class="o">-</span><span class="n">xshift</span><span class="p">);</span>
<span class="n">zfid</span><span class="o">=-</span><span class="n">zshift</span><span class="o">/</span><span class="p">(</span><span class="n">SIfield</span><span class="o">.</span><span class="n">focallength</span><span class="o">-</span><span class="n">xshift</span><span class="p">);</span>
</pre></div>
</div>
<p>This function also applies a temperature-dependent fid offset if <code class="docutils literal notranslate"><span class="pre">t_ccd</span></code> and <code class="docutils literal notranslate"><span class="pre">date</span></code>
are supplied and the <code class="docutils literal notranslate"><span class="pre">PROSECO_ENABLE_FID_OFFSET</span></code> env var is <code class="docutils literal notranslate"><span class="pre">&quot;True&quot;</span></code> or not set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detector</strong> – ‘ACIS-S’ | ‘ACIS-I’ | ‘HRC-S’ | ‘HRC-I’</p></li>
<li><p><strong>focus_offset</strong> – SIM focus offset [steps]</p></li>
<li><p><strong>sim_offset</strong> – SIM translation offset from nominal [steps]</p></li>
<li><p><strong>t_ccd</strong> – CCD temperature (C)</p></li>
<li><p><strong>date</strong> – date (CxoTime compatible)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>yang, zang where each is a np.array of angles [arcsec]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-proseco.core">
<span id="core"></span><h2>Core<a class="headerlink" href="#module-proseco.core" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="proseco.core.ACACatalogTable">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">proseco.core.</span></span><span class="sig-name descname"><span class="pre">ACACatalogTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#ACACatalogTable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.ACACatalogTable" title="Link to this definition">¶</a></dt>
<dd><p>Base class for representing ACA catalogs in star selection.  This
can apply to acq, guide and fid entries.</p>
<p>Features:
- Inherits from astropy Table
- Logging
- Serialization to/from pickle
- Predefined formatting for nicer representations</p>
<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.ACACatalogTable.empty">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#ACACatalogTable.empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.ACACatalogTable.empty" title="Link to this definition">¶</a></dt>
<dd><p>Return a minimal ACACatalogTable which satisfies API requirements.  Currently
this means that it has an ‘id’ column which can be examined for length.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>StarsTable of stars (empty)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="proseco.core.ACACatalogTable.exception">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">exception</span></span><a class="headerlink" href="#proseco.core.ACACatalogTable.exception" title="Link to this definition">¶</a></dt>
<dd><p>Return string traceback of a top-level caught exception, or “” (empty
string) if no exception has been caught.  Mostly for use in Matlab
interface.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.ACACatalogTable.from_pickle">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obsid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rootdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#ACACatalogTable.from_pickle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.ACACatalogTable.from_pickle" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Construct table from pickle file in</dt><dd><p><code class="docutils literal notranslate"><span class="pre">&lt;rootdir&gt;/obs&lt;obsid&gt;/&lt;name&gt;.pkl</span></code></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obsid</strong> – Obsid</p></li>
<li><p><strong>rootdir</strong> – root directory (default=’.’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>catalog table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.ACACatalogTable.get_catalog_for_plot">
<span class="sig-name descname"><span class="pre">get_catalog_for_plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#ACACatalogTable.get_catalog_for_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.ACACatalogTable.get_catalog_for_plot" title="Link to this definition">¶</a></dt>
<dd><p>Return value of <code class="docutils literal notranslate"><span class="pre">catalog</span></code> for plot_stars() call for this object</p>
<p>For ACACatalogTable this is the self Table object but with the possibility
of changing all the <cite>type</cite> column values to self.catalog_type (e.g. ‘ACQ’).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.ACACatalogTable.has_column_spoiler">
<span class="sig-name descname"><span class="pre">has_column_spoiler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#ACACatalogTable.has_column_spoiler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.ACACatalogTable.has_column_spoiler" title="Link to this definition">¶</a></dt>
<dd><p>Returns True if <code class="docutils literal notranslate"><span class="pre">cand</span></code> has a column spoiler downstream toward readout
register which is:
- at least 4.5 mag brighter (ACA.col_spoiler_mag_diff)
- within 10 pixels in column (ACA.col_spoiler_pix_sep)</p>
<p>Also records a log entry for detected spoilers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand</strong> – object with ‘row’, ‘col’, and ‘mag’ items</p></li>
<li><p><strong>stars</strong> – StarsTable</p></li>
<li><p><strong>mask</strong> – boolean mask of stars to check (default=None =&gt; no mask)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.ACACatalogTable.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#ACACatalogTable.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.ACACatalogTable.log" title="Link to this definition">¶</a></dt>
<dd><p>Add a log event to self.log_info[‘events’] include <code class="docutils literal notranslate"><span class="pre">data</span></code> (which
is typically, but not required to be, a string).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.ACACatalogTable.pformat">
<span class="sig-name descname"><span class="pre">pformat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#ACACatalogTable.pformat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.ACACatalogTable.pformat" title="Link to this definition">¶</a></dt>
<dd><p>Return a list of lines for the formatted string representation of
the table.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">max_lines=None</span></code> is supplied then the height of the
screen terminal is used to set <code class="docutils literal notranslate"><span class="pre">max_lines</span></code>.  If the terminal
height cannot be determined then the default will be
determined using the <code class="docutils literal notranslate"><span class="pre">astropy.conf.max_lines</span></code> configuration
item. If a negative value of <code class="docutils literal notranslate"><span class="pre">max_lines</span></code> is supplied then
there is no line limit applied (default).</p>
<p>The same applies for <code class="docutils literal notranslate"><span class="pre">max_width</span></code> except the configuration item  is
<code class="docutils literal notranslate"><span class="pre">astropy.conf.max_width</span></code>.</p>
<section id="id9">
<h3>Parameters<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>max_lines<span class="classifier">int or None</span></dt><dd><p>Maximum number of rows to output</p>
</dd>
<dt>max_width<span class="classifier">int or None</span></dt><dd><p>Maximum character width of output</p>
</dd>
<dt>show_name<span class="classifier">bool</span></dt><dd><p>Include a header row for column names. Default is True.</p>
</dd>
<dt>show_unit<span class="classifier">bool</span></dt><dd><p>Include a header row for unit.  Default is to show a row
for units only if one or more columns has a defined value
for the unit.</p>
</dd>
<dt>show_dtype<span class="classifier">bool</span></dt><dd><p>Include a header row for column dtypes. Default is True.</p>
</dd>
<dt>html<span class="classifier">bool</span></dt><dd><p>Format the output as an HTML table. Default is False.</p>
</dd>
<dt>tableid<span class="classifier">str or None</span></dt><dd><p>An ID tag for the table; only used if html is set.  Default is
“table{id}”, where id is the unique integer id of the table object,
id(self)</p>
</dd>
<dt>align<span class="classifier">str or list or tuple or None</span></dt><dd><p>Left/right alignment of columns. Default is right (None) for all
columns. Other allowed values are ‘&gt;’, ‘&lt;’, ‘^’, and ‘0=’ for
right, left, centered, and 0-padded, respectively. A list of
strings can be provided for alignment of tables with multiple
columns.</p>
</dd>
<dt>tableclass<span class="classifier">str or list of str or None</span></dt><dd><p>CSS classes for the table; only used if html is set.  Default is
None.</p>
</dd>
</dl>
</section>
<section id="id10">
<h3>Returns<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>lines<span class="classifier">list</span></dt><dd><p>Formatted table as a list of strings.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.ACACatalogTable.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#ACACatalogTable.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.ACACatalogTable.plot" title="Link to this definition">¶</a></dt>
<dd><p>Plot the catalog and background stars.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – matplotlib axes object for plotting to (optional)</p></li>
<li><p><strong>kwargs</strong> – other keyword args for plot_stars</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.ACACatalogTable.pprint">
<span class="sig-name descname"><span class="pre">pprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#ACACatalogTable.pprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.ACACatalogTable.pprint" title="Link to this definition">¶</a></dt>
<dd><p>Print a formatted string representation of the table.</p>
<p>If no value of <code class="docutils literal notranslate"><span class="pre">max_lines</span></code> is supplied then the height of the
screen terminal is used to set <code class="docutils literal notranslate"><span class="pre">max_lines</span></code>.  If the terminal
height cannot be determined then the default is taken from the
configuration item <code class="docutils literal notranslate"><span class="pre">astropy.conf.max_lines</span></code>.  If a negative
value of <code class="docutils literal notranslate"><span class="pre">max_lines</span></code> is supplied then there is no line limit
applied.</p>
<p>The same applies for max_width except the configuration item is
<code class="docutils literal notranslate"><span class="pre">astropy.conf.max_width</span></code>.</p>
<section id="id11">
<h3>Parameters<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>max_lines<span class="classifier">int or None</span></dt><dd><p>Maximum number of lines in table output.</p>
</dd>
<dt>max_width<span class="classifier">int or None</span></dt><dd><p>Maximum character width of output.</p>
</dd>
<dt>show_name<span class="classifier">bool</span></dt><dd><p>Include a header row for column names. Default is True.</p>
</dd>
<dt>show_unit<span class="classifier">bool</span></dt><dd><p>Include a header row for unit.  Default is to show a row
for units only if one or more columns has a defined value
for the unit.</p>
</dd>
<dt>show_dtype<span class="classifier">bool</span></dt><dd><p>Include a header row for column dtypes. Default is False.</p>
</dd>
<dt>align<span class="classifier">str or list or tuple or None</span></dt><dd><p>Left/right alignment of columns. Default is right (None) for all
columns. Other allowed values are ‘&gt;’, ‘&lt;’, ‘^’, and ‘0=’ for
right, left, centered, and 0-padded, respectively. A list of
strings can be provided for alignment of tables with multiple
columns.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.ACACatalogTable.process_include_ids">
<span class="sig-name descname"><span class="pre">process_include_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand_stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#ACACatalogTable.process_include_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.ACACatalogTable.process_include_ids" title="Link to this definition">¶</a></dt>
<dd><p>Ensure that the candidate acqs/guides table has stars that were forced to be included.</p>
<p>Updates <code class="docutils literal notranslate"><span class="pre">cand_stars</span></code> in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand_stars</strong> – candidate acquisition or guide stars table</p></li>
<li><p><strong>stars</strong> – stars table</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.ACACatalogTable.set_stars">
<span class="sig-name descname"><span class="pre">set_stars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_near_fov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/proseco/core.html#ACACatalogTable.set_stars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.ACACatalogTable.set_stars" title="Link to this definition">¶</a></dt>
<dd><p>Set the object <code class="docutils literal notranslate"><span class="pre">stars</span></code> attribute to an appropriate StarsTable object.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">acqs</span></code> is defined that will be a previously computed AcqTable with
<code class="docutils literal notranslate"><span class="pre">stars</span></code> already available, so use that.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acqs</strong> – AcqTable for same observation</p></li>
<li><p><strong>filter_near_fov</strong> – include only stars in or near ACA FOV</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.ACACatalogTable.to_pickle">
<span class="sig-name descname"><span class="pre">to_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rootdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#ACACatalogTable.to_pickle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.ACACatalogTable.to_pickle" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Write the catalog table as pickle to:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">&lt;rootdir&gt;/obs&lt;obsid&gt;/&lt;name&gt;.pkl</span></code></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rootdir</strong> – root directory (default=’.’)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="proseco.core.ACACatalogTable.warnings">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">warnings</span></span><a class="headerlink" href="#proseco.core.ACACatalogTable.warnings" title="Link to this definition">¶</a></dt>
<dd><p>Return list of warnings in the event log.  This returns just the
string message without context.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proseco.core.AliasAttribute">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">proseco.core.</span></span><span class="sig-name descname"><span class="pre">AliasAttribute</span></span><a class="reference internal" href="_modules/proseco/core.html#AliasAttribute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.AliasAttribute" title="Link to this definition">¶</a></dt>
<dd><p>Descriptor to define class attributes which can be accessed via
either &lt;name&gt; or &lt;name&gt;_&lt;subclass&gt;.</p>
<p>For instance the <code class="docutils literal notranslate"><span class="pre">dither</span></code> attribute is found in both AcqTable and
GuideTable, but in general these can be different for the two cases.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">get_aca_catalog()</span></code> function handles this by accepting <code class="docutils literal notranslate"><span class="pre">dither_acq</span></code>
and <code class="docutils literal notranslate"><span class="pre">dither_guide</span></code>.  In order to be able to generically pass the
same commmon kwargs to <code class="docutils literal notranslate"><span class="pre">get_acq_catalog</span></code> and <code class="docutils literal notranslate"><span class="pre">get_guide_catalog</span></code>,
we define the AliasAttribute to allow set/get of either <code class="docutils literal notranslate"><span class="pre">dither</span></code>
or <code class="docutils literal notranslate"><span class="pre">dither_acq</span></code> (or <code class="docutils literal notranslate"><span class="pre">dither_guide</span></code>).</p>
<p>The &lt;subclass&gt; name is the lower case version of everything before
<code class="docutils literal notranslate"><span class="pre">Table</span></code> in the subclass name, so GuideTable =&gt; ‘guide’.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proseco.core.BaseCatalogTable">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">proseco.core.</span></span><span class="sig-name descname"><span class="pre">BaseCatalogTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#BaseCatalogTable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.BaseCatalogTable" title="Link to this definition">¶</a></dt>
<dd><p>Base class for representing star catalogs or ACA (guide/acq/fid) catalogs.</p>
<p>Features:
- Inherits from astropy Table
- Predefined formatting for nicer representations
- Indexing on ‘id’ column</p>
<dl class="py property">
<dt class="sig sig-object py" id="proseco.core.BaseCatalogTable.bad_stars">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">bad_stars</span></span><a class="headerlink" href="#proseco.core.BaseCatalogTable.bad_stars" title="Link to this definition">¶</a></dt>
<dd><p>Back-compatibility property for bad_stars_mask</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="proseco.core.BaseCatalogTable.bad_stars_mask">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">bad_stars_mask</span></span><a class="headerlink" href="#proseco.core.BaseCatalogTable.bad_stars_mask" title="Link to this definition">¶</a></dt>
<dd><p>Mask of stars that are not acceptable candidates for the parent class.  This
basically applies to guide and acq, though ACACatalog uses a hybrid of
those two.</p>
<p>This is mostly used for plotting, corresponding to the <code class="docutils literal notranslate"><span class="pre">bad_stars</span></code>
arg of plot_stars where bad stars are plotting in a distinctive color.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.BaseCatalogTable.get_candidates_mask">
<span class="sig-name descname"><span class="pre">get_candidates_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#BaseCatalogTable.get_candidates_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.BaseCatalogTable.get_candidates_mask" title="Link to this definition">¶</a></dt>
<dd><p>Return a boolean mask indicating which <code class="docutils literal notranslate"><span class="pre">stars</span></code> are acceptable candidates
for the parent class.  This basically applies to guide and acq, though
ACACatalog uses a hybrid of those two.</p>
<p>This is used directly in selection of candidates.  For the base class all
stars are considered acceptable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stars</strong> – StarsTable of stars</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bool mask</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.BaseCatalogTable.get_id">
<span class="sig-name descname"><span class="pre">get_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#BaseCatalogTable.get_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.BaseCatalogTable.get_id" title="Link to this definition">¶</a></dt>
<dd><p>Return row corresponding to <code class="docutils literal notranslate"><span class="pre">id</span></code> in id column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> – int
row <code class="docutils literal notranslate"><span class="pre">id</span></code> column value</p></li>
<li><p><strong>mon</strong> – bool
return ID for corresponding MON star (default=False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>table Row</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.BaseCatalogTable.get_id_idx">
<span class="sig-name descname"><span class="pre">get_id_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#BaseCatalogTable.get_id_idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.BaseCatalogTable.get_id_idx" title="Link to this definition">¶</a></dt>
<dd><p>Return row corresponding to <code class="docutils literal notranslate"><span class="pre">id</span></code> in id column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> – int
row <code class="docutils literal notranslate"><span class="pre">id</span></code> column value</p></li>
<li><p><strong>mon</strong> – bool
return ID for corresponding MON star (default=False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>table row index (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.BaseCatalogTable.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#BaseCatalogTable.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.BaseCatalogTable.plot" title="Link to this definition">¶</a></dt>
<dd><p>Plot the catalog and background stars.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – matplotlib axes object for plotting to (optional)</p></li>
<li><p><strong>kwargs</strong> – other keyword args for plot_stars</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proseco.core.StarsTable">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">proseco.core.</span></span><span class="sig-name descname"><span class="pre">StarsTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#StarsTable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.StarsTable" title="Link to this definition">¶</a></dt>
<dd><p>Table of stars for use in proseco.</p>
<p>This is meant to be created only with available class methods:</p>
<ul class="simple">
<li><p>from_agasc() : calls agasc.get_agasc_cone()</p></li>
<li><p>from_stars() : init from the results of a call to get_agasc_cone()</p></li>
<li><p>from_agasc_ids() : calls agasc.get_stars()</p></li>
<li><p>empty() : empty catalog, then use add_* methods to add stars</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.StarsTable.add_agasc_id">
<span class="sig-name descname"><span class="pre">add_agasc_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agasc_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#StarsTable.add_agasc_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.StarsTable.add_agasc_id" title="Link to this definition">¶</a></dt>
<dd><p>Add a AGASC star to the current StarsTable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>agasc_id</strong> – AGASC ID of the star to add</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.StarsTable.add_fake_constellation">
<span class="sig-name descname"><span class="pre">add_fake_constellation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_stars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">attrs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#StarsTable.add_fake_constellation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.StarsTable.add_fake_constellation" title="Link to this definition">¶</a></dt>
<dd><p>Add a fake constellation of up to 8 stars consisting of a cross and square:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="o">*</span>
    <span class="o">*</span>   <span class="o">*</span>
  <span class="o">*</span>       <span class="o">*</span>
    <span class="o">*</span>   <span class="o">*</span>
      <span class="o">*</span>

<span class="n">yangs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span>
<span class="n">zangs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span>
</pre></div>
</div>
<p>Additional star table attributes can be specified as keyword args.  All
attributes are broadcast as needed.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stars</span> <span class="o">=</span> <span class="n">StarsTable</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stars</span><span class="o">.</span><span class="n">add_fake_constellation</span><span class="p">(</span><span class="n">n_stars</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">mag</span><span class="o">=</span><span class="mf">7.5</span><span class="p">,</span> <span class="n">ASPQ1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stars</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;yang&#39;</span><span class="p">,</span> <span class="s1">&#39;zang&#39;</span><span class="p">,</span> <span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="s1">&#39;ASPQ1&#39;</span><span class="p">]</span>
<span class="go">&lt;StarsTable length=4&gt;</span>
<span class="go">  id    yang     zang     mag   ASPQ1</span>
<span class="go">int32 float64  float64  float32 int16</span>
<span class="go">----- -------- -------- ------- -----</span>
<span class="go">  100  1000.00     0.00    7.50     0</span>
<span class="go">  101     0.00  1000.00    7.50     1</span>
<span class="go">  102 -1000.00     0.00    7.50     0</span>
<span class="go">  103     0.00 -1000.00    7.50    20</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_stars</strong> – number of stars (default=8, max=8)</p></li>
<li><p><strong>size</strong> – size of constellation [arcsec] (default=2000)</p></li>
<li><p><strong>mag</strong> – star magnitudes (default=7.0)</p></li>
<li><p><strong>**attrs</strong> – other star table attributes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.StarsTable.add_fake_star">
<span class="sig-name descname"><span class="pre">add_fake_star</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">star</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#StarsTable.add_fake_star"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.StarsTable.add_fake_star" title="Link to this definition">¶</a></dt>
<dd><p>Add a star to the current StarsTable.</p>
<p>The input kwargs must have at least:
- One of yang/zang, ra/dec, or row/col
- mag
- mag_err (defaults to 0.1)</p>
<p>Mag_err is set to 0.1 if not provided.  Yang/zang, ra/dec, and row/col
RA/DEC_PMCORR, MAG_ACA, MAG_ACA_ERR will all be set according to the
primary inputs unless explicitly provided.  All the rest will be set
to default “good”” values that will preclude initial exclusion of the star.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**star</strong> – keyword arg attributes corresponding to StarTable columns</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.StarsTable.empty">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">att</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#StarsTable.empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.StarsTable.empty" title="Link to this definition">¶</a></dt>
<dd><p>Return an empty StarsTable suitable for generating synthetic tables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>att</strong> – any Quat-compatible attitude</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>StarsTable of stars (empty)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.StarsTable.from_agasc">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_agasc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">att</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#StarsTable.from_agasc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.StarsTable.from_agasc" title="Link to this definition">¶</a></dt>
<dd><p>Get AGASC stars in the ACA FOV.  This uses the proseco-AGASC, so only stars
within 3-sigma of 11.5 mag or those nearby a potential guide/acq star are
included.</p>
<p>This uses an AGASC file path defined by the AGASC_HDF_FILE env var or the latest
version of proseco_agasc in the default AGASC directory. The AGASC directory can
be set with the AGASC_DIR env var.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>att</strong> – any Quat-compatible attitude</p></li>
<li><p><strong>date</strong> – DateTime compatible date for star proper motion (default=NOW)</p></li>
<li><p><strong>radius</strong> – star cone radius [deg] (default=1.2)</p></li>
<li><p><strong>logger</strong> – logger object (default=None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>StarsTable of stars</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.StarsTable.from_agasc_ids">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_agasc_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">att</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agasc_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#StarsTable.from_agasc_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.StarsTable.from_agasc_ids" title="Link to this definition">¶</a></dt>
<dd><p>Get AGASC stars in the ACA FOV using a list of AGASC IDs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>att</strong> – any Quat-compatible attitude</p></li>
<li><p><strong>agasc_ids</strong> – sequence of AGASC ID values</p></li>
<li><p><strong>date</strong> – DateTime compatible date for star proper motion (default=NOW)</p></li>
<li><p><strong>logger</strong> – logger object (default=None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>StarsTable of stars</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.StarsTable.from_stars">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_stars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">att</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#proseco.core.StarsTable" title="proseco.core.StarsTable"><span class="pre">StarsTable</span></a></span></span><a class="reference internal" href="_modules/proseco/core.html#StarsTable.from_stars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.StarsTable.from_stars" title="Link to this definition">¶</a></dt>
<dd><p>Return a StarsTable from an existing AGASC stars query.  This just updates
columns in place.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">stars</span></code> is a StarsTable, the attitude of that object <code class="docutils literal notranslate"><span class="pre">stars.att</span></code> must
match <code class="docutils literal notranslate"><span class="pre">att</span></code> to within 0.001 arcsec in pitch, yaw, and roll.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>att</strong> – any Quat-compatible attitude</p></li>
<li><p><strong>stars</strong> – Table of stars</p></li>
<li><p><strong>logger</strong> – logger object (default=None)</p></li>
<li><p><strong>copy</strong> – copy <code class="docutils literal notranslate"><span class="pre">stars</span></code> table columns</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>StarsTable of stars</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.StarsTable.get_catalog_for_plot">
<span class="sig-name descname"><span class="pre">get_catalog_for_plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#StarsTable.get_catalog_for_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.StarsTable.get_catalog_for_plot" title="Link to this definition">¶</a></dt>
<dd><p>Return value of <code class="docutils literal notranslate"><span class="pre">catalog</span></code> for plot_stars() call for this object</p>
<p>For StarsTable this is None (no catalog).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proseco.core.StarsTable.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#StarsTable.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.StarsTable.plot" title="Link to this definition">¶</a></dt>
<dd><p>Plot the star field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – matplotlib axes object for plotting to (optional)</p></li>
<li><p><strong>kwargs</strong> – other keywords for plot_stars</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.core.bin2x2">
<span class="sig-prename descclassname"><span class="pre">proseco.core.</span></span><span class="sig-name descname"><span class="pre">bin2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#bin2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.bin2x2" title="Link to this definition">¶</a></dt>
<dd><p>Bin 2-d <code class="docutils literal notranslate"><span class="pre">arr</span></code> in 2x2 blocks.  Requires that <code class="docutils literal notranslate"><span class="pre">arr</span></code> has even shape sizes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.core.calc_spoiler_impact">
<span class="sig-prename descclassname"><span class="pre">proseco.core.</span></span><span class="sig-name descname"><span class="pre">calc_spoiler_impact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dark_bgd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#calc_spoiler_impact"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.calc_spoiler_impact" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the centroid shift and relative image brightness change
for <code class="docutils literal notranslate"><span class="pre">star</span></code> when nearby <code class="docutils literal notranslate"><span class="pre">stars</span></code> are included.  The assumption
is that <code class="docutils literal notranslate"><span class="pre">star</span></code> has ASPQ1 &gt; 0 so it is known to have some spoiler.</p>
<p>The returned norm_frac is the ratio of the summed (mouse-bitten)
counts in the original image over the spoiled image, so a value less
than 1.0 is a problem since it indicates a high background.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star</strong> – object with row, col, mag keys/cols</p></li>
<li><p><strong>stars</strong> – StarsTable</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>d_yang, d_zang, norm_frac</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.core.get_dim_res">
<span class="sig-prename descclassname"><span class="pre">proseco.core.</span></span><span class="sig-name descname"><span class="pre">get_dim_res</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">halfws</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#get_dim_res"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.get_dim_res" title="Link to this definition">¶</a></dt>
<dd><p>Get ACA search command <code class="docutils literal notranslate"><span class="pre">dim</span></code> and <code class="docutils literal notranslate"><span class="pre">res</span></code> corresponding to <code class="docutils literal notranslate"><span class="pre">halfws</span></code></p>
<p>From DM11, where <code class="docutils literal notranslate"><span class="pre">dim</span></code> is a 6-bit uint and <code class="docutils literal notranslate"><span class="pre">res</span></code> is a 1-bit uint with
0 =&gt; “L” and 1 =&gt; H”.</p>
<p>Define the search region (<code class="docutils literal notranslate"><span class="pre">dim</span></code>) for any image data slot to be a square
centered at the commanded angular Z and Y coordinates. When the high
resolution flag (H) (<code class="docutils literal notranslate"><span class="pre">res</span></code>) in command word 3 is true (=1), the half width
of the square, in arc seconds, is (20 + 5D) where D is the dimension field
in command word 2. When the H flag is false (=0), the half width, is (20 +
40D) arc seconds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>halfws</strong> – array of int
Half-widths (arcsec)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple (int array, int array)
ACA search DIM and RES entries corresponding to halfws</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.core.get_image_props">
<span class="sig-prename descclassname"><span class="pre">proseco.core.</span></span><span class="sig-name descname"><span class="pre">get_image_props</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ccd_img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bgd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#get_image_props"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.get_image_props" title="Link to this definition">¶</a></dt>
<dd><p>Do a pseudo-read and compute the background-subtracted magnitude
of the image.  Returns the 8x8 image and mag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ccd_image</strong> – full-frame CCD image (e.g. dark current, with or without stars).</p></li>
<li><p><strong>c_row</strong> – int row at center (readout row-4 to row+4)</p></li>
<li><p><strong>c_col</strong> – int col at center</p></li>
<li><p><strong>bgd</strong> – background to subtract at each pixel.  If None then compute flight bgd.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>8x8 image (ndarray), image mag</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.core.get_img_size">
<span class="sig-prename descclassname"><span class="pre">proseco.core.</span></span><span class="sig-name descname"><span class="pre">get_img_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_fids</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#get_img_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.get_img_size" title="Link to this definition">¶</a></dt>
<dd><p>Get guide image readout size from <code class="docutils literal notranslate"><span class="pre">n_fids</span></code>.</p>
<p>This is the core definition for the default rule specifying the guide star
image size.</p>
<p>ER’s (observations with no fids) always get 8x8.</p>
<p>OR’s (observations with fids) default to 8x8. This can be globally
overridden by setting the <code class="docutils literal notranslate"><span class="pre">PROSECO_OR_IMAGE_SIZE</span></code> environment
variable to “4”, “6” or “8”. As a reminder the <code class="docutils literal notranslate"><span class="pre">img_size_guide</span></code> parameter
of <code class="docutils literal notranslate"><span class="pre">get_aca_catalog</span></code> can also be set.</p>
<section id="id12">
<h3>Parameters<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>n_fids<span class="classifier">int</span></dt><dd><p>Number of fids in the catalog</p>
</dd>
</dl>
</section>
<section id="id13">
<h3>Returns<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>int</dt><dd><p>Guide star image readout size to be used in a catalog (6 or 8)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.core.get_kwargs_from_starcheck_text">
<span class="sig-prename descclassname"><span class="pre">proseco.core.</span></span><span class="sig-name descname"><span class="pre">get_kwargs_from_starcheck_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_cat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_catalog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#get_kwargs_from_starcheck_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.get_kwargs_from_starcheck_text" title="Link to this definition">¶</a></dt>
<dd><p>Get proseco kwargs using the exact catalog from the starcheck output text
<code class="docutils literal notranslate"><span class="pre">obs_text</span></code>.  Mostly copied from annie/annie (should move into mica.starcheck
one day).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_text</strong> – text copied from starcheck output</p></li>
<li><p><strong>include_cat</strong> – include the original catalog in returned kwargs</p></li>
<li><p><strong>force_catalog</strong> – force proseco catalog to match the original catalog</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict of keyword args corresponding to proseco args</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.core.get_monitors">
<span class="sig-prename descclassname"><span class="pre">proseco.core.</span></span><span class="sig-name descname"><span class="pre">get_monitors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obsid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#get_monitors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.get_monitors" title="Link to this definition">¶</a></dt>
<dd><p>Generate a list of monitor requests for an existing catalog</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obsid</strong> – int, obsid</p></li>
<li><p><strong>cat</strong> – starcheck catalog from get_catalog</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of monitor requests</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.core.includes_for_obsid">
<span class="sig-prename descclassname"><span class="pre">proseco.core.</span></span><span class="sig-name descname"><span class="pre">includes_for_obsid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obsid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#includes_for_obsid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.includes_for_obsid" title="Link to this definition">¶</a></dt>
<dd><p>Return a dict with the include_ids_acq, include_halfws_acq and include_ids_guide
lists for the as-run flight catalog of <code class="docutils literal notranslate"><span class="pre">obsid</span></code>.  Useful for forcing catalog.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">proseco</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_aca_catalog</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">proseco.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">includes_for_obsid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obsid</span> <span class="o">=</span> <span class="mi">8008</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aca</span> <span class="o">=</span> <span class="n">get_aca_catalog</span><span class="p">(</span><span class="n">obsid</span><span class="p">,</span> <span class="o">**</span><span class="n">includes_for_obsid</span><span class="p">(</span><span class="n">obsid</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obsid</strong> – int, obsid</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.core.pea_reject_image">
<span class="sig-prename descclassname"><span class="pre">proseco.core.</span></span><span class="sig-name descname"><span class="pre">pea_reject_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#pea_reject_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.pea_reject_image" title="Link to this definition">¶</a></dt>
<dd><p>Check if PEA would reject image (too narrow, too peaky, etc)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.core.table_to_html">
<span class="sig-prename descclassname"><span class="pre">proseco.core.</span></span><span class="sig-name descname"><span class="pre">table_to_html</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tbl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/core.html#table_to_html"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.core.table_to_html" title="Link to this definition">¶</a></dt>
<dd><p>Make an HTML representation of a table</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tbl</strong> – astropy Table</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-proseco.diff">
<span id="diff"></span><h2>Diff<a class="headerlink" href="#module-proseco.diff" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="proseco.diff.CatalogDiff">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">proseco.diff.</span></span><span class="sig-name descname"><span class="pre">CatalogDiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_html</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/diff.html#CatalogDiff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.diff.CatalogDiff" title="Link to this definition">¶</a></dt>
<dd><p>Represent an ACA catalog diff as either HTML or plain text</p>
<dl class="py method">
<dt class="sig sig-object py" id="proseco.diff.CatalogDiff.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/diff.html#CatalogDiff.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.diff.CatalogDiff.write" title="Link to this definition">¶</a></dt>
<dd><p>Write output to <code class="docutils literal notranslate"><span class="pre">out_file</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out_file</strong> – str, Path
Output file</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.diff.catalog_diff">
<span class="sig-prename descclassname"><span class="pre">proseco.diff.</span></span><span class="sig-name descname"><span class="pre">catalog_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cats1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cats2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'html'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/diff.html#catalog_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.diff.catalog_diff" title="Link to this definition">¶</a></dt>
<dd><p>Return the diff of ACA catalogs <code class="docutils literal notranslate"><span class="pre">cats1</span></code> and <code class="docutils literal notranslate"><span class="pre">cats2</span></code>.</p>
<p>The output is returned in a <code class="docutils literal notranslate"><span class="pre">CatalogDiff</span></code> object that will display the
formatted diff in Jupyter notebook, or return the diff text via the <code class="docutils literal notranslate"><span class="pre">text</span></code>
attribute. The difference text can be written to file with the
<code class="docutils literal notranslate"><span class="pre">CatalogDiff.write</span></code> method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cats1</strong> – Table, list of Table
First ACA catalog(s)</p></li>
<li><p><strong>cats2</strong> – Table, list of Table
Second ACA catalog(s)</p></li>
<li><p><strong>style</strong> – str
Diff style, either ‘html’, ‘content’, or ‘unified’</p></li>
<li><p><strong>names</strong> – list, str
Column names in output as list or space-delimited str.
Default = ‘idx id slot type sz dim res halfw’</p></li>
<li><p><strong>labels</strong> – list, None
Label for catalog used in banner at top of lines</p></li>
<li><p><strong>formats</strong> – dict, None
Dict of column names and format specifiers e.g. {‘mag’: ‘6.3f’}</p></li>
<li><p><strong>sort_name</strong> – str
Column name for sorting catalog within sections (default=’id’)</p></li>
<li><p><strong>section_lines</strong> – bool
Add separator lines between types (default=True)</p></li>
<li><p><strong>n_context</strong> – int
Number of context lines for unified, context diffs (default=3)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CatalogDiff</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proseco.diff.get_catalog_lines">
<span class="sig-prename descclassname"><span class="pre">proseco.diff.</span></span><span class="sig-name descname"><span class="pre">get_catalog_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/proseco/diff.html#get_catalog_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proseco.diff.get_catalog_lines" title="Link to this definition">¶</a></dt>
<dd><p>Get list of lines representing catalog suitable for diffing.</p>
<p>This function sorts the catalog into fids, guides, monitors,and acquisition
stars and outputs the table into a separate list of lines. In addition:</p>
<ul class="simple">
<li><p>Translate HRC fid ids 7-10 and 11-14 to 1-4. Values in the range 7-14
come from starcheck, but proseco uses 1-4.</p></li>
<li><p>Optionally add a banner at the top with a label identifying the catalog,
e.g. with the obsid. This banner is useful for diffing all the catalogs
from a load, and helps to ensure that the diff algorithm stays on track.</p></li>
<li><p>Guide stars that are BOT are labeled as GU*, and conversely acq stars
that are BOT are labeled as AC*. This gives some visibility into BOT stars
while keeping the diffs clean.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cat</strong> – Table
Star catalog</p></li>
<li><p><strong>names</strong> – str, list
Column names in the output lines for diffing</p></li>
<li><p><strong>section_lines</strong> – bool
Add separator lines between types (default=True)</p></li>
<li><p><strong>formats</strong> – dict, None
Dict of column names and format specifiers</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">API documentation</a><ul>
<li><a class="reference internal" href="#module-proseco.catalog">Full catalog</a><ul>
<li><a class="reference internal" href="#proseco.catalog.ACATable"><code class="docutils literal notranslate"><span class="pre">ACATable</span></code></a><ul>
<li><a class="reference internal" href="#proseco.catalog.ACATable.empty"><code class="docutils literal notranslate"><span class="pre">ACATable.empty()</span></code></a></li>
<li><a class="reference internal" href="#proseco.catalog.ACATable.get_candidates_mask"><code class="docutils literal notranslate"><span class="pre">ACATable.get_candidates_mask()</span></code></a></li>
<li><a class="reference internal" href="#proseco.catalog.ACATable.get_review_table"><code class="docutils literal notranslate"><span class="pre">ACATable.get_review_table()</span></code></a></li>
<li><a class="reference internal" href="#proseco.catalog.ACATable.make_report"><code class="docutils literal notranslate"><span class="pre">ACATable.make_report()</span></code></a></li>
<li><a class="reference internal" href="#proseco.catalog.ACATable.optimize_acqs_fids"><code class="docutils literal notranslate"><span class="pre">ACATable.optimize_acqs_fids()</span></code></a></li>
<li><a class="reference internal" href="#proseco.catalog.ACATable.set_attrs_from_kwargs"><code class="docutils literal notranslate"><span class="pre">ACATable.set_attrs_from_kwargs()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#proseco.catalog.ObcCat"><code class="docutils literal notranslate"><span class="pre">ObcCat</span></code></a><ul>
<li><a class="reference internal" href="#proseco.catalog.ObcCat.add"><code class="docutils literal notranslate"><span class="pre">ObcCat.add()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#proseco.catalog.get_aca_catalog"><code class="docutils literal notranslate"><span class="pre">get_aca_catalog()</span></code></a></li>
<li><a class="reference internal" href="#proseco.catalog.get_effective_t_ccd"><code class="docutils literal notranslate"><span class="pre">get_effective_t_ccd()</span></code></a></li>
<li><a class="reference internal" href="#proseco.catalog.merge_cats"><code class="docutils literal notranslate"><span class="pre">merge_cats()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-proseco.acq">Acquisition</a><ul>
<li><a class="reference internal" href="#proseco.acq.AcqTable"><code class="docutils literal notranslate"><span class="pre">AcqTable</span></code></a><ul>
<li><a class="reference internal" href="#proseco.acq.AcqTable.calc_p_brightest"><code class="docutils literal notranslate"><span class="pre">AcqTable.calc_p_brightest()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.calc_p_safe"><code class="docutils literal notranslate"><span class="pre">AcqTable.calc_p_safe()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.empty"><code class="docutils literal notranslate"><span class="pre">AcqTable.empty()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.get_acq_candidates"><code class="docutils literal notranslate"><span class="pre">AcqTable.get_acq_candidates()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.get_box_sizes"><code class="docutils literal notranslate"><span class="pre">AcqTable.get_box_sizes()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.get_candidates_mask"><code class="docutils literal notranslate"><span class="pre">AcqTable.get_candidates_mask()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.get_initial_catalog"><code class="docutils literal notranslate"><span class="pre">AcqTable.get_initial_catalog()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.get_log_p_2_or_fewer"><code class="docutils literal notranslate"><span class="pre">AcqTable.get_log_p_2_or_fewer()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.get_obs_info"><code class="docutils literal notranslate"><span class="pre">AcqTable.get_obs_info()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.get_overlap_penalties"><code class="docutils literal notranslate"><span class="pre">AcqTable.get_overlap_penalties()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.has_nearby_spoiler"><code class="docutils literal notranslate"><span class="pre">AcqTable.has_nearby_spoiler()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.in_bad_star_set"><code class="docutils literal notranslate"><span class="pre">AcqTable.in_bad_star_set()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.make_report"><code class="docutils literal notranslate"><span class="pre">AcqTable.make_report()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.optimize_acq_halfw"><code class="docutils literal notranslate"><span class="pre">AcqTable.optimize_acq_halfw()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.optimize_acqs_halfw"><code class="docutils literal notranslate"><span class="pre">AcqTable.optimize_acqs_halfw()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.optimize_catalog"><code class="docutils literal notranslate"><span class="pre">AcqTable.optimize_catalog()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.process_include_ids"><code class="docutils literal notranslate"><span class="pre">AcqTable.process_include_ids()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.select_best_p_acqs"><code class="docutils literal notranslate"><span class="pre">AcqTable.select_best_p_acqs()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.update_idxs_halfws"><code class="docutils literal notranslate"><span class="pre">AcqTable.update_idxs_halfws()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.AcqTable.update_p_acq_column"><code class="docutils literal notranslate"><span class="pre">AcqTable.update_p_acq_column()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#proseco.acq.box_overlap"><code class="docutils literal notranslate"><span class="pre">box_overlap()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.boxes_overlap"><code class="docutils literal notranslate"><span class="pre">boxes_overlap()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.calc_p_brightest_compare"><code class="docutils literal notranslate"><span class="pre">calc_p_brightest_compare()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.calc_p_on_ccd"><code class="docutils literal notranslate"><span class="pre">calc_p_on_ccd()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.filter_box_sizes_for_maxmag"><code class="docutils literal notranslate"><span class="pre">filter_box_sizes_for_maxmag()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.get_acq_candidates_mask"><code class="docutils literal notranslate"><span class="pre">get_acq_candidates_mask()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.get_acq_catalog"><code class="docutils literal notranslate"><span class="pre">get_acq_catalog()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.get_imposter_stars"><code class="docutils literal notranslate"><span class="pre">get_imposter_stars()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.get_intruders"><code class="docutils literal notranslate"><span class="pre">get_intruders()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.get_maxmag"><code class="docutils literal notranslate"><span class="pre">get_maxmag()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.get_p_man_err"><code class="docutils literal notranslate"><span class="pre">get_p_man_err()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.get_spoiler_stars"><code class="docutils literal notranslate"><span class="pre">get_spoiler_stars()</span></code></a></li>
<li><a class="reference internal" href="#proseco.acq.load_maxmags"><code class="docutils literal notranslate"><span class="pre">load_maxmags()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-proseco.guide">Guide</a><ul>
<li><a class="reference internal" href="#proseco.guide.GuideTable"><code class="docutils literal notranslate"><span class="pre">GuideTable</span></code></a><ul>
<li><a class="reference internal" href="#proseco.guide.GuideTable.drop_excess_bonus_stars"><code class="docutils literal notranslate"><span class="pre">GuideTable.drop_excess_bonus_stars()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.exclude_overlaps"><code class="docutils literal notranslate"><span class="pre">GuideTable.exclude_overlaps()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.filter_candidates_for_fids"><code class="docutils literal notranslate"><span class="pre">GuideTable.filter_candidates_for_fids()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.filter_candidates_for_monitors"><code class="docutils literal notranslate"><span class="pre">GuideTable.filter_candidates_for_monitors()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.get_candidates_mask"><code class="docutils literal notranslate"><span class="pre">GuideTable.get_candidates_mask()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.get_img_size"><code class="docutils literal notranslate"><span class="pre">GuideTable.get_img_size()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.get_initial_guide_candidates"><code class="docutils literal notranslate"><span class="pre">GuideTable.get_initial_guide_candidates()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.in_bad_star_list"><code class="docutils literal notranslate"><span class="pre">GuideTable.in_bad_star_list()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.make_report"><code class="docutils literal notranslate"><span class="pre">GuideTable.make_report()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.process_exclude_ids"><code class="docutils literal notranslate"><span class="pre">GuideTable.process_exclude_ids()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.process_include_ids"><code class="docutils literal notranslate"><span class="pre">GuideTable.process_include_ids()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.process_monitors_post"><code class="docutils literal notranslate"><span class="pre">GuideTable.process_monitors_post()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.reject"><code class="docutils literal notranslate"><span class="pre">GuideTable.reject()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.run_search_stages"><code class="docutils literal notranslate"><span class="pre">GuideTable.run_search_stages()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.search_stage"><code class="docutils literal notranslate"><span class="pre">GuideTable.search_stage()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.GuideTable.select_catalog"><code class="docutils literal notranslate"><span class="pre">GuideTable.select_catalog()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#proseco.guide.check_column_spoilers"><code class="docutils literal notranslate"><span class="pre">check_column_spoilers()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.check_fid_trap"><code class="docutils literal notranslate"><span class="pre">check_fid_trap()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.check_mag_spoilers"><code class="docutils literal notranslate"><span class="pre">check_mag_spoilers()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.check_single_cluster"><code class="docutils literal notranslate"><span class="pre">check_single_cluster()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.check_spoil_contrib"><code class="docutils literal notranslate"><span class="pre">check_spoil_contrib()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.dist2"><code class="docutils literal notranslate"><span class="pre">dist2()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.get_ax_range"><code class="docutils literal notranslate"><span class="pre">get_ax_range()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.get_guide_candidates"><code class="docutils literal notranslate"><span class="pre">get_guide_candidates()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.get_guide_candidates_mask"><code class="docutils literal notranslate"><span class="pre">get_guide_candidates_mask()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.get_guide_catalog"><code class="docutils literal notranslate"><span class="pre">get_guide_catalog()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.get_imposter_mags"><code class="docutils literal notranslate"><span class="pre">get_imposter_mags()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.get_pixmag_for_offset"><code class="docutils literal notranslate"><span class="pre">get_pixmag_for_offset()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.get_t_ccds_bonus"><code class="docutils literal notranslate"><span class="pre">get_t_ccds_bonus()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.has_spoiler_in_box"><code class="docutils literal notranslate"><span class="pre">has_spoiler_in_box()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.run_cluster_checks"><code class="docutils literal notranslate"><span class="pre">run_cluster_checks()</span></code></a></li>
<li><a class="reference internal" href="#proseco.guide.spoiled_by_bad_pixel"><code class="docutils literal notranslate"><span class="pre">spoiled_by_bad_pixel()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-proseco.fid">Fid</a><ul>
<li><a class="reference internal" href="#proseco.fid.FidTable"><code class="docutils literal notranslate"><span class="pre">FidTable</span></code></a><ul>
<li><a class="reference internal" href="#proseco.fid.FidTable.get_cand_fid_sets"><code class="docutils literal notranslate"><span class="pre">FidTable.get_cand_fid_sets()</span></code></a></li>
<li><a class="reference internal" href="#proseco.fid.FidTable.get_fid_candidates"><code class="docutils literal notranslate"><span class="pre">FidTable.get_fid_candidates()</span></code></a></li>
<li><a class="reference internal" href="#proseco.fid.FidTable.is_excluded"><code class="docutils literal notranslate"><span class="pre">FidTable.is_excluded()</span></code></a></li>
<li><a class="reference internal" href="#proseco.fid.FidTable.near_hot_or_bad_pixel"><code class="docutils literal notranslate"><span class="pre">FidTable.near_hot_or_bad_pixel()</span></code></a></li>
<li><a class="reference internal" href="#proseco.fid.FidTable.off_ccd"><code class="docutils literal notranslate"><span class="pre">FidTable.off_ccd()</span></code></a></li>
<li><a class="reference internal" href="#proseco.fid.FidTable.set_initial_catalog"><code class="docutils literal notranslate"><span class="pre">FidTable.set_initial_catalog()</span></code></a></li>
<li><a class="reference internal" href="#proseco.fid.FidTable.set_slot_column"><code class="docutils literal notranslate"><span class="pre">FidTable.set_slot_column()</span></code></a></li>
<li><a class="reference internal" href="#proseco.fid.FidTable.set_spoilers_score"><code class="docutils literal notranslate"><span class="pre">FidTable.set_spoilers_score()</span></code></a></li>
<li><a class="reference internal" href="#proseco.fid.FidTable.spoils"><code class="docutils literal notranslate"><span class="pre">FidTable.spoils()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#proseco.fid.get_fid_catalog"><code class="docutils literal notranslate"><span class="pre">get_fid_catalog()</span></code></a></li>
<li><a class="reference internal" href="#proseco.fid.get_fid_positions"><code class="docutils literal notranslate"><span class="pre">get_fid_positions()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-proseco.core">Core</a><ul>
<li><a class="reference internal" href="#proseco.core.ACACatalogTable"><code class="docutils literal notranslate"><span class="pre">ACACatalogTable</span></code></a><ul>
<li><a class="reference internal" href="#proseco.core.ACACatalogTable.empty"><code class="docutils literal notranslate"><span class="pre">ACACatalogTable.empty()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.ACACatalogTable.exception"><code class="docutils literal notranslate"><span class="pre">ACACatalogTable.exception</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.ACACatalogTable.from_pickle"><code class="docutils literal notranslate"><span class="pre">ACACatalogTable.from_pickle()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.ACACatalogTable.get_catalog_for_plot"><code class="docutils literal notranslate"><span class="pre">ACACatalogTable.get_catalog_for_plot()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.ACACatalogTable.has_column_spoiler"><code class="docutils literal notranslate"><span class="pre">ACACatalogTable.has_column_spoiler()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.ACACatalogTable.log"><code class="docutils literal notranslate"><span class="pre">ACACatalogTable.log()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.ACACatalogTable.pformat"><code class="docutils literal notranslate"><span class="pre">ACACatalogTable.pformat()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.ACACatalogTable.plot"><code class="docutils literal notranslate"><span class="pre">ACACatalogTable.plot()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.ACACatalogTable.pprint"><code class="docutils literal notranslate"><span class="pre">ACACatalogTable.pprint()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.ACACatalogTable.process_include_ids"><code class="docutils literal notranslate"><span class="pre">ACACatalogTable.process_include_ids()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.ACACatalogTable.set_stars"><code class="docutils literal notranslate"><span class="pre">ACACatalogTable.set_stars()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.ACACatalogTable.to_pickle"><code class="docutils literal notranslate"><span class="pre">ACACatalogTable.to_pickle()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.ACACatalogTable.warnings"><code class="docutils literal notranslate"><span class="pre">ACACatalogTable.warnings</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#proseco.core.AliasAttribute"><code class="docutils literal notranslate"><span class="pre">AliasAttribute</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.BaseCatalogTable"><code class="docutils literal notranslate"><span class="pre">BaseCatalogTable</span></code></a><ul>
<li><a class="reference internal" href="#proseco.core.BaseCatalogTable.bad_stars"><code class="docutils literal notranslate"><span class="pre">BaseCatalogTable.bad_stars</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.BaseCatalogTable.bad_stars_mask"><code class="docutils literal notranslate"><span class="pre">BaseCatalogTable.bad_stars_mask</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.BaseCatalogTable.get_candidates_mask"><code class="docutils literal notranslate"><span class="pre">BaseCatalogTable.get_candidates_mask()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.BaseCatalogTable.get_id"><code class="docutils literal notranslate"><span class="pre">BaseCatalogTable.get_id()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.BaseCatalogTable.get_id_idx"><code class="docutils literal notranslate"><span class="pre">BaseCatalogTable.get_id_idx()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.BaseCatalogTable.plot"><code class="docutils literal notranslate"><span class="pre">BaseCatalogTable.plot()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#proseco.core.StarsTable"><code class="docutils literal notranslate"><span class="pre">StarsTable</span></code></a><ul>
<li><a class="reference internal" href="#proseco.core.StarsTable.add_agasc_id"><code class="docutils literal notranslate"><span class="pre">StarsTable.add_agasc_id()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.StarsTable.add_fake_constellation"><code class="docutils literal notranslate"><span class="pre">StarsTable.add_fake_constellation()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.StarsTable.add_fake_star"><code class="docutils literal notranslate"><span class="pre">StarsTable.add_fake_star()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.StarsTable.empty"><code class="docutils literal notranslate"><span class="pre">StarsTable.empty()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.StarsTable.from_agasc"><code class="docutils literal notranslate"><span class="pre">StarsTable.from_agasc()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.StarsTable.from_agasc_ids"><code class="docutils literal notranslate"><span class="pre">StarsTable.from_agasc_ids()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.StarsTable.from_stars"><code class="docutils literal notranslate"><span class="pre">StarsTable.from_stars()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.StarsTable.get_catalog_for_plot"><code class="docutils literal notranslate"><span class="pre">StarsTable.get_catalog_for_plot()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.StarsTable.plot"><code class="docutils literal notranslate"><span class="pre">StarsTable.plot()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#proseco.core.bin2x2"><code class="docutils literal notranslate"><span class="pre">bin2x2()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.calc_spoiler_impact"><code class="docutils literal notranslate"><span class="pre">calc_spoiler_impact()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.get_dim_res"><code class="docutils literal notranslate"><span class="pre">get_dim_res()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.get_image_props"><code class="docutils literal notranslate"><span class="pre">get_image_props()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.get_img_size"><code class="docutils literal notranslate"><span class="pre">get_img_size()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.get_kwargs_from_starcheck_text"><code class="docutils literal notranslate"><span class="pre">get_kwargs_from_starcheck_text()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.get_monitors"><code class="docutils literal notranslate"><span class="pre">get_monitors()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.includes_for_obsid"><code class="docutils literal notranslate"><span class="pre">includes_for_obsid()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.pea_reject_image"><code class="docutils literal notranslate"><span class="pre">pea_reject_image()</span></code></a></li>
<li><a class="reference internal" href="#proseco.core.table_to_html"><code class="docutils literal notranslate"><span class="pre">table_to_html()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-proseco.diff">Diff</a><ul>
<li><a class="reference internal" href="#proseco.diff.CatalogDiff"><code class="docutils literal notranslate"><span class="pre">CatalogDiff</span></code></a><ul>
<li><a class="reference internal" href="#proseco.diff.CatalogDiff.write"><code class="docutils literal notranslate"><span class="pre">CatalogDiff.write()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#proseco.diff.catalog_diff"><code class="docutils literal notranslate"><span class="pre">catalog_diff()</span></code></a></li>
<li><a class="reference internal" href="#proseco.diff.get_catalog_lines"><code class="docutils literal notranslate"><span class="pre">get_catalog_lines()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>


  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="index.html"
                          title="previous chapter">Proseco</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="unit_tests.html"
                          title="next chapter">Unit tests</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/api.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<form action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="_sources/api.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2018, Tom Aldcroft, Jean Connelly.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 9.1.0. &nbsp;
  </p>
</footer>
  </body>
</html>